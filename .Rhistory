} else {
paste0('</', options$wrap, '>')
}
})
library(knitr)
# knitr::opts_chunk$set(cache = TRUE, warning = FALSE, message = FALSE, dpi = 180, out.extra='class = "img-responsive"')
knit_hooks$set(wrap = function(before, options, envir){
if (before){
paste0('<', options$wrap, '>')
} else {
paste0('</', options$wrap, '>')
}
})
knitr::opts_chunk$set(warning = FALSE, message = FALSE, dpi = 180, fig.height = 5, fig.width = 7, fig.align = "center")
options(width=140, dplyr.width = 150)
library(tigris)
wi <- counties("Wisconsin", cb = TRUE)
wi_original <- wi
library(hexmapr)
wi_details <- get_shape_details(wi)
wi@data$xcentroid <- coordinates(wi)[,1]
wi@data$ycentroid <- coordinates(wi)[,2]
library(dplyr)
clean <- function(shape){
shape@data$id = rownames(shape@data)
shape.points = fortify(shape, region="id")
shape.df = left_join(shape.points, shape@data, by="id")
}
new_cells_hex <-  calculate_cell_size(wi_original, wi_details,0.03, 'hexagonal', 28)
resulthex <- assign_polygons(wi_original,new_cells_hex)
result_df_hex <- clean(resulthex)
library(dplyr)
library(ggplot2)
clean <- function(shape){
shape@data$id = rownames(shape@data)
shape.points = fortify(shape, region="id")
shape.df = left_join(shape.points, shape@data, by="id")
}
new_cells_hex <-  calculate_cell_size(wi_original, wi_details,0.03, 'hexagonal', 28)
resulthex <- assign_polygons(wi_original,new_cells_hex)
result_df_hex <- clean(resulthex)
new_cells_square <-  calculate_cell_size(wi_original, wi_details,0.03, 'regular', 7)
resultsquare <- assign_polygons(wi_original,new_cells_square)
result_df_square <- clean(resultsquare)
hexplot <- ggplot(resulthex) +
geom_polygon( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_equal() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
library(viridis)
hexplot <- ggplot(resulthex) +
geom_polygon( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_equal() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
hexplot
library(viridis)
hexplot <- ggplot(result_df_hex) +
geom_polygon( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_equal() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
hexplot
squareplot <- ggplot(result_df_square) +
geom_polygon( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_equal() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
squareplot
st_as_sf(resulthex)
sfResultHex <- st_as_sf(resulthex)
ggplot(sfResultHex) +
geom_polygon( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
ggplot(sfResultHex) +
geom_polygon( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))
ggplot(sfResultHex) +
geom_polygon( fill = as.numeric(ALAND), group = group)
?geom_sf
ggplot(sfResultHex) +
geom_sf( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
ggplot(sfResultHex) +
geom_sf( aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))
ggplot(sfResultHex) +
geom_sf(fill = as.numeric(ALAND), group = group)
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND), group = group))
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND)))
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_equal() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "transparent") +
coord_equal() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "transparent") +
coord_sf() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_sf() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_sf() +
scale_fill_viridis() +
guides(fill=FALSE)
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
coord_sf() +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
?theme_void
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +   geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_minimal()
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void()
?theme
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void() +
theme(panel.grid = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme(panel.grid = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void() +
theme(panel.grid.major = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void() +
theme(panel.background = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme_void() +
theme(panel.background = element_rect(fill = NA))
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme(panel.background = element_rect(fill = NA))
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(sfResultHex) +
geom_sf(aes(fill = as.numeric(ALAND)), color = "transparent") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_viridis() +
guides(fill=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
class(sfResultHex)
sf
sfResultHex
all_results <- read_csv("https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv")
all_results <- read.csv("https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv", stringsAsFactors = FALSE)
wisconsin <- all_results %>%
filter(str_detect(fips, "^55"))
??str_detect
library(stringr)
all_results <- read.csv("https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv", stringsAsFactors = FALSE)
wisconsin <- all_results %>%
filter(str_detect(fips, "^55"))
wisconsin_spread <- wisconsin %>%
filter(cand %in% c("Donald Trump", "Hillary Clinton")) %>%
select(fips, cand, votes, total_votes) %>%
spread(cand, votes)
library(tidyr)
wisconsin <- all_results %>%
filter(str_detect(fips, "^55"))
wisconsin_spread <- wisconsin %>%
filter(cand %in% c("Donald Trump", "Hillary Clinton")) %>%
select(fips, cand, votes, total_votes) %>%
spread(cand, votes)
wisconsin_spread <- wisconsin_spread %>% mutate(voteDiff = `Donald Trump` - `Hillary Clinton`,
pctDiff = `Donald Trump`/total_votes - `Hillary Clinton`/total_votes,
weight = total_votes/ sum(total_votes))
wiHex <- merge(sfResultHex, wisconsin_spread, by.x = "GEOID", by.y = "fips")
wiSquare <- merge(sfResultSquare, wisconsin_spread, by.x = "GEOID", by.y = "fips")
sfResultSquare <- st_as_sf(resultsquare)
wiSquare <- merge(sfResultSquare, wisconsin_spread, by.x = "GEOID", by.y = "fips")
wiHex
wiHexPlot <- ggplot(wiHex) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE)
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiHexPlot <- ggplot(wiHex) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE)
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
?brewer.pal
??brewer.pal
library(RColorBrewer)
wiHexPlot <- ggplot(wiHex) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiHexPlot
library(RColorBrewer)
wiHex <- merge(sfResultHex, wisconsin_spread, by.x = "GEOID", by.y = "fips")
wiSquare <- merge(sfResultSquare, wisconsin_spread, by.x = "GEOID", by.y = "fips")
wiHexPlot <- ggplot(wiHex) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiHexPlot
wiSquarePlot <- ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiSquarePlot
wiSquarePlot
wiHexPlot
View(wisconsin_spread)
wiSquare$weight/max(wiSquare$weight)
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent", alpha = wiSquare$weight/max(wiSquare$weight)) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent", alpha = wiSquare$weight/max(wiSquare$weight) * 2) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "transparent", alpha = wiSquare$weight/max(wiSquare$weight) * 2) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), alpha = wiSquare$weight/max(wiSquare$weight)) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f3f3f3", alpha = wiSquare$weight/max(wiSquare$weight) * 2) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f3f3f3", alpha = wiSquare$weight/max(wiSquare$weight)) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "white") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f3f3f3", alpha = wiSquare$weight/max(wiSquare$weight) * 2) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiSquarePlot <- ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f5f5f5", alpha = wiSquare$weight/max(wiSquare$weight)) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiSquarePlot
?cut
cut(wisconsin_spread$weight,breaks = c(0,.01,.05,.1,1))
cut(wisconsin_spread$weight,breaks = c(0,.01,.05,.1,1), labels = c("Less than 1%", "1 to 5 Percent", "5 to 10 Percent", "More than 10 Percent"))
cut(wisconsin_spread$weight,breaks = c(0,.01,.05,.1,1), labels = c("Less than 1 Percent", "1 to 5 Percent", "5 to 10 Percent", "More than 10 Percent"))
cut(wisconsin_spread$weight,breaks = c(-1, -0.1, -.05, -0.01, 0, .01, .05, .1, 1), labels = c("R - More than 10 Percent", "R - 5 to 10 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - 5 to 10 Percent", "D - More than 10 Percent"))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.1, -.05, -0.01, 0, .01, .05, .1, 1), labels = c("R - More than 10 Percent", "R - 5 to 10 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - 5 to 10 Percent", "D - More than 10 Percent")))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.1, -0.01, -0.001, 0, .001, .01, .1, 1), labels = c("R - More than 10 Percent", "R - 5 to 10 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - 5 to 10 Percent", "D - More than 10 Percent")))
cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -.01, -0.001, 0, .001, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - .01 to 1 Percent", "R - Less than 0.01 Percent", "D - Less than 0.01 Percent", "D - .01 to 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent"))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -.01, -0.001, 0, .001, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - .01 to 1 Percent", "R - Less than 0.01 Percent", "D - Less than 0.01 Percent", "D - .01 to 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -.01, -0.01, 0, .01, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.1 to 1 Percent", "R - Less than 0.1 Percent", "D - Less than 0.1 Percent", "D - 0.1 to 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -.01, -0.001, 0, .001, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.1 to 1 Percent", "R - Less than 0.1 Percent", "D - Less than 0.1 Percent", "D - 0.1 to 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
table(cut(wisconsin_spread$weight*100,breaks = c(-1, -0.05, -.01, -0.001, 0, .001, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.1 to 1 Percent", "R - Less than 0.1 Percent", "D - Less than 0.1 Percent", "D - 0.1 to 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
cut(wisconsin_spread$weight)
quantile(wisconsin_spread$weight)
0, less than 1.5 %,1.5%, more than 5%
rev(0, .015, .05, 1)
rev(c(0, .015, .05, 1))
c(1, 0.05, 0.015, 0, .015, .05, 1)
cut(wisconsin_spread$weight,breaks = c(1, 0.05, 0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "Les than 1 Percent", "R - Less than 1 Percent", D - 1 to 5 Percent", "D - More than 5 Percent"))
cut(wisconsin_spread$weight,breaks = c(1, 0.05, 0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "Les than 1 Percent", "R - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent"))
cut(wisconsin_spread$weight,breaks = c(1, 0.05, 0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent"))
cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent"))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
?abs
wisconsin_spread$weight <- ifelse(wisconsin_spread$pctDiff > 0 , wisconsin_spread$weight, -wisconsin_spread$weight)
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
wisconsin_spread$weight <- ifelse(wisconsin_spread$pctDiff > 0 , -wisconsin_spread$weight, wisconsin_spread$weight)
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
wisconsin_spread <- wisconsin %>%
filter(cand %in% c("Donald Trump", "Hillary Clinton")) %>%
select(fips, cand, votes, total_votes) %>%
spread(cand, votes)
wisconsin_spread <- wisconsin_spread %>% mutate(voteDiff = `Donald Trump` - `Hillary Clinton`,
pctDiff = `Donald Trump`/total_votes - `Hillary Clinton`/total_votes,
weight = total_votes/ sum(total_votes))
wisconsin_spread$weight <- ifelse(wisconsin_spread$pctDiff > 0 , -wisconsin_spread$weight, wisconsin_spread$weight)
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, 0, .01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - Less than 1 Percent", "D - Less than 1 Percent", "D - 1 to 5 Percent", "D - More than 5 Percent")))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, -0.001, 0, 0.001, 0.01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.1 to 1 Percent","R - Less than 0.1 Percent","D - Less than 0.1 Percent",  "D - 0.1 to 1 Percent","D - 1 to 5 Percent", "D - More than 5 Percent")))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, -0.005, 0, 0.005, 0.01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.1 to 1 Percent","R - Less than 0.1 Percent","D - Less than 0.1 Percent",  "D - 0.1 to 1 Percent","D - 1 to 5 Percent", "D - More than 5 Percent")))
table(cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, -0.005, 0, 0.005, 0.01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.5 to 1 Percent","R - Less than 0.5 Percent","D - Less than 0.5 Percent",  "D - 0.5 to 1 Percent","D - 1 to 5 Percent", "D - More than 5 Percent")))
abs(wiSquare$weight/max(wiSquare$weight))
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wisconsin_spread$breaks <- cut(wisconsin_spread$weight,breaks = c(-1, -0.05, -0.01, -0.005, 0, 0.005, 0.01, .05, 1), labels = c("R - More than 5 Percent", "R - 1 to 5 Percent", "R - 0.5 to 1 Percent","R - Less than 0.5 Percent","D - Less than 0.5 Percent",  "D - 0.5 to 1 Percent","D - 1 to 5 Percent", "D - More than 5 Percent"))
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(breaks)), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiSquare <- merge(sfResultSquare, wisconsin_spread, by.x = "GEOID", by.y = "fips")
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(breaks)), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(breaks)), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_gradientn(name = "pctDiff", colours = brewer.pal(8, "RdBu")) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(breaks)), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill = breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
guides(alpha=FALSE) + scale_fill_discrete()
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
?scale_fill_discrete
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_discrete(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu")))
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black")
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(pctDiff)), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black")
wiSquare
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(breaks)), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_discrete(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu")))
ggplot(wiSquare) +
geom_sf(aes(fill = as.numeric(breaks)), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black")
ggplot(wiSquare) +
geom_sf(aes(fill = breaks), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_discrete(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu")))
ggplot(wiSquare) +
geom_sf(aes(fill = breaks), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black")
gg <- ggplot(wiSquare) +
geom_sf(aes(fill = breaks), color = "#f5f5f5", alpha = abs(wiSquare$weight/max(wiSquare$weight))) +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black")
gg <- ggplot(wiSquare) +
geom_sf(aes(fill = breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black")
gg
gg + scale_fill_discrete()
gg + scale_fill_manual(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu"))) +
gg + scale_fill_manual(name = "pctDiff", colours = rev(brewer.pal(8, "RdBu")))
gg + scale_fill_manual(name = "pctDiff", values = rev(brewer.pal(8, "RdBu")))
ggplot(wiSquare) +
geom_sf(aes(fill =breaks) color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_manual(name = "pctDiff", values = rev(brewer.pal(8, "RdBu")))
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill =breaks) color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_manual(name = "pctDiff", values = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill =breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_manual(name = "pctDiff", values = rev(brewer.pal(8, "RdBu"))) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
ggplot(wiSquare) +
geom_sf(aes(fill =breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_manual(name = "pctDiff", values = brewer.pal(8, "RdBu")) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiHex <- merge(sfResultHex, wisconsin_spread, by.x = "GEOID", by.y = "fips")
wiHexPlot <- ggplot(wiHex) +
geom_sf(aes(fill =breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_manual(name = "pctDiff", values = brewer.pal(8, "RdBu")) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiHexPlot
wiSquarePlot <- ggplot(wiSquare) +
geom_sf(aes(fill =breaks), color = "#f5f5f5") +
geom_text(aes(V1, V2, label = NAME), size=4, color = "black") +
scale_fill_manual(name = "pctDiff", values = brewer.pal(8, "RdBu")) +
guides(alpha=FALSE) +
theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())
wiSquarePlot
paste0(formatC(seq(0, 25000, by = 5000), format="f", digits = 0, big.mark=","))
paste0(formatC(seq(0, 50, by = 10), format="f", digits = 0), "%")
blogdown::serve_site()
setwd('/home/michael/Documents/mikeleeco.github.com/')
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
