<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Hexmapr on Michael Lee</title>
    <link>/tags/hexmapr/index.xml</link>
    <description>Recent content in Hexmapr on Michael Lee</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <managingEditor>mdlee12@gmail.com (Michael Lee)</managingEditor>
    <webMaster>mdlee12@gmail.com (Michael Lee)</webMaster>
    <atom:link href="/tags/hexmapr/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Wisconsin State Hex Grid - Mapping 2016 Presidential Results</title>
      <link>/posts/2017-11-16-wi-presidential-results-using-hexmapr/</link>
      <pubDate>Thu, 16 Nov 2017 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/posts/2017-11-16-wi-presidential-results-using-hexmapr/</guid>
      <description>&lt;div id=&#34;neat-package-alert&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;NEAT PACKAGE ALERT!&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
My 1st R package! &lt;a href=&#34;https://t.co/dI3GJbC7FQ&#34;&gt;https://t.co/dI3GJbC7FQ&lt;/a&gt; Automatically turn geospatial polygons like states into regular/hexagonal grids &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#ggplot2&lt;/a&gt; &lt;a href=&#34;https://t.co/dxvYCZWJzU&#34;&gt;pic.twitter.com/dxvYCZWJzU&lt;/a&gt;
&lt;/p&gt;
— J Bailey (&lt;span class=&#34;citation&#34;&gt;@iammrbailey&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/iammrbailey/status/925346870381240320?ref_src=twsrc%5Etfw&#34;&gt;October 31, 2017&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;p&gt;I’ve been thinking about implementing something like this for a while - got excited by this tweet I thought I would do some exploring and write out a post over the weekend. Creating a county-level hex grid of Wisconsin makes for a perfect supplment to my earlier post about &lt;a href=&#34;https://www.mikelee.co/posts/2016-12-26-wisconsin-presidential-election-results/&#34;&gt;mapping the 2016 Wisconsin presidential results&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;lets-make-a-hex-grid-of-wisconsin&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Let’s make a hex grid of Wisconsin&lt;/h2&gt;
&lt;p&gt;The first thing we’ll do is retrieve a Wisconsin shapefile; we can use the &lt;code&gt;tigris&lt;/code&gt; package developed by Kyle Walker to pull a 2010 census shapefile of Wisconsin counties:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tigris)
wi &amp;lt;- counties(&amp;quot;Wisconsin&amp;quot;, cb = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
  |                                                                                                                                        
  |                                                                                                                                  |   0%
  |                                                                                                                                        
  |=                                                                                                                                 |   0%
  |                                                                                                                                        
  |=                                                                                                                                 |   1%
  |                                                                                                                                        
  |==                                                                                                                                |   1%
  |                                                                                                                                        
  |==                                                                                                                                |   2%
  |                                                                                                                                        
  |===                                                                                                                               |   2%
  |                                                                                                                                        
  |===                                                                                                                               |   3%
  |                                                                                                                                        
  |====                                                                                                                              |   3%
  |                                                                                                                                        
  |=====                                                                                                                             |   4%
  |                                                                                                                                        
  |======                                                                                                                            |   4%
  |                                                                                                                                        
  |======                                                                                                                            |   5%
  |                                                                                                                                        
  |=======                                                                                                                           |   5%
  |                                                                                                                                        
  |=======                                                                                                                           |   6%
  |                                                                                                                                        
  |========                                                                                                                          |   6%
  |                                                                                                                                        
  |========                                                                                                                          |   7%
  |                                                                                                                                        
  |=========                                                                                                                         |   7%
  |                                                                                                                                        
  |==========                                                                                                                        |   7%
  |                                                                                                                                        
  |==========                                                                                                                        |   8%
  |                                                                                                                                        
  |===========                                                                                                                       |   8%
  |                                                                                                                                        
  |===========                                                                                                                       |   9%
  |                                                                                                                                        
  |============                                                                                                                      |   9%
  |                                                                                                                                        
  |============                                                                                                                      |  10%
  |                                                                                                                                        
  |=============                                                                                                                     |  10%
  |                                                                                                                                        
  |==============                                                                                                                    |  10%
  |                                                                                                                                        
  |==============                                                                                                                    |  11%
  |                                                                                                                                        
  |===============                                                                                                                   |  11%
  |                                                                                                                                        
  |===============                                                                                                                   |  12%
  |                                                                                                                                        
  |================                                                                                                                  |  12%
  |                                                                                                                                        
  |================                                                                                                                  |  13%
  |                                                                                                                                        
  |=================                                                                                                                 |  13%
  |                                                                                                                                        
  |==================                                                                                                                |  13%
  |                                                                                                                                        
  |==================                                                                                                                |  14%
  |                                                                                                                                        
  |===================                                                                                                               |  14%
  |                                                                                                                                        
  |===================                                                                                                               |  15%
  |                                                                                                                                        
  |====================                                                                                                              |  15%
  |                                                                                                                                        
  |====================                                                                                                              |  16%
  |                                                                                                                                        
  |=====================                                                                                                             |  16%
  |                                                                                                                                        
  |======================                                                                                                            |  17%
  |                                                                                                                                        
  |=======================                                                                                                           |  17%
  |                                                                                                                                        
  |=======================                                                                                                           |  18%
  |                                                                                                                                        
  |========================                                                                                                          |  18%
  |                                                                                                                                        
  |========================                                                                                                          |  19%
  |                                                                                                                                        
  |=========================                                                                                                         |  19%
  |                                                                                                                                        
  |=========================                                                                                                         |  20%
  |                                                                                                                                        
  |==========================                                                                                                        |  20%
  |                                                                                                                                        
  |===========================                                                                                                       |  20%
  |                                                                                                                                        
  |===========================                                                                                                       |  21%
  |                                                                                                                                        
  |============================                                                                                                      |  21%
  |                                                                                                                                        
  |============================                                                                                                      |  22%
  |                                                                                                                                        
  |=============================                                                                                                     |  22%
  |                                                                                                                                        
  |=============================                                                                                                     |  23%
  |                                                                                                                                        
  |==============================                                                                                                    |  23%
  |                                                                                                                                        
  |===============================                                                                                                   |  24%
  |                                                                                                                                        
  |================================                                                                                                  |  24%
  |                                                                                                                                        
  |================================                                                                                                  |  25%
  |                                                                                                                                        
  |=================================                                                                                                 |  25%
  |                                                                                                                                        
  |=================================                                                                                                 |  26%
  |                                                                                                                                        
  |==================================                                                                                                |  26%
  |                                                                                                                                        
  |===================================                                                                                               |  27%
  |                                                                                                                                        
  |====================================                                                                                              |  27%
  |                                                                                                                                        
  |====================================                                                                                              |  28%
  |                                                                                                                                        
  |=====================================                                                                                             |  28%
  |                                                                                                                                        
  |=====================================                                                                                             |  29%
  |                                                                                                                                        
  |======================================                                                                                            |  29%
  |                                                                                                                                        
  |======================================                                                                                            |  30%
  |                                                                                                                                        
  |=======================================                                                                                           |  30%
  |                                                                                                                                        
  |========================================                                                                                          |  30%
  |                                                                                                                                        
  |========================================                                                                                          |  31%
  |                                                                                                                                        
  |=========================================                                                                                         |  31%
  |                                                                                                                                        
  |=========================================                                                                                         |  32%
  |                                                                                                                                        
  |==========================================                                                                                        |  32%
  |                                                                                                                                        
  |==========================================                                                                                        |  33%
  |                                                                                                                                        
  |===========================================                                                                                       |  33%
  |                                                                                                                                        
  |============================================                                                                                      |  34%
  |                                                                                                                                        
  |=============================================                                                                                     |  34%
  |                                                                                                                                        
  |=============================================                                                                                     |  35%
  |                                                                                                                                        
  |==============================================                                                                                    |  35%
  |                                                                                                                                        
  |==============================================                                                                                    |  36%
  |                                                                                                                                        
  |===============================================                                                                                   |  36%
  |                                                                                                                                        
  |===============================================                                                                                   |  37%
  |                                                                                                                                        
  |================================================                                                                                  |  37%
  |                                                                                                                                        
  |=================================================                                                                                 |  37%
  |                                                                                                                                        
  |=================================================                                                                                 |  38%
  |                                                                                                                                        
  |==================================================                                                                                |  38%
  |                                                                                                                                        
  |==================================================                                                                                |  39%
  |                                                                                                                                        
  |===================================================                                                                               |  39%
  |                                                                                                                                        
  |===================================================                                                                               |  40%
  |                                                                                                                                        
  |====================================================                                                                              |  40%
  |                                                                                                                                        
  |=====================================================                                                                             |  41%
  |                                                                                                                                        
  |======================================================                                                                            |  41%
  |                                                                                                                                        
  |======================================================                                                                            |  42%
  |                                                                                                                                        
  |=======================================================                                                                           |  42%
  |                                                                                                                                        
  |=======================================================                                                                           |  43%
  |                                                                                                                                        
  |========================================================                                                                          |  43%
  |                                                                                                                                        
  |=========================================================                                                                         |  43%
  |                                                                                                                                        
  |=========================================================                                                                         |  44%
  |                                                                                                                                        
  |==========================================================                                                                        |  44%
  |                                                                                                                                        
  |==========================================================                                                                        |  45%
  |                                                                                                                                        
  |===========================================================                                                                       |  45%
  |                                                                                                                                        
  |===========================================================                                                                       |  46%
  |                                                                                                                                        
  |============================================================                                                                      |  46%
  |                                                                                                                                        
  |=============================================================                                                                     |  47%
  |                                                                                                                                        
  |==============================================================                                                                    |  47%
  |                                                                                                                                        
  |==============================================================                                                                    |  48%
  |                                                                                                                                        
  |===============================================================                                                                   |  48%
  |                                                                                                                                        
  |===============================================================                                                                   |  49%
  |                                                                                                                                        
  |================================================================                                                                  |  49%
  |                                                                                                                                        
  |================================================================                                                                  |  50%
  |                                                                                                                                        
  |=================================================================                                                                 |  50%
  |                                                                                                                                        
  |==================================================================                                                                |  50%
  |                                                                                                                                        
  |==================================================================                                                                |  51%
  |                                                                                                                                        
  |===================================================================                                                               |  51%
  |                                                                                                                                        
  |===================================================================                                                               |  52%
  |                                                                                                                                        
  |====================================================================                                                              |  52%
  |                                                                                                                                        
  |====================================================================                                                              |  53%
  |                                                                                                                                        
  |=====================================================================                                                             |  53%
  |                                                                                                                                        
  |======================================================================                                                            |  54%
  |                                                                                                                                        
  |=======================================================================                                                           |  54%
  |                                                                                                                                        
  |=======================================================================                                                           |  55%
  |                                                                                                                                        
  |========================================================================                                                          |  55%
  |                                                                                                                                        
  |========================================================================                                                          |  56%
  |                                                                                                                                        
  |=========================================================================                                                         |  56%
  |                                                                                                                                        
  |=========================================================================                                                         |  57%
  |                                                                                                                                        
  |==========================================================================                                                        |  57%
  |                                                                                                                                        
  |===========================================================================                                                       |  57%
  |                                                                                                                                        
  |===========================================================================                                                       |  58%
  |                                                                                                                                        
  |============================================================================                                                      |  58%
  |                                                                                                                                        
  |============================================================================                                                      |  59%
  |                                                                                                                                        
  |=============================================================================                                                     |  59%
  |                                                                                                                                        
  |=============================================================================                                                     |  60%
  |                                                                                                                                        
  |==============================================================================                                                    |  60%
  |                                                                                                                                        
  |===============================================================================                                                   |  60%
  |                                                                                                                                        
  |===============================================================================                                                   |  61%
  |                                                                                                                                        
  |================================================================================                                                  |  61%
  |                                                                                                                                        
  |================================================================================                                                  |  62%
  |                                                                                                                                        
  |=================================================================================                                                 |  62%
  |                                                                                                                                        
  |=================================================================================                                                 |  63%
  |                                                                                                                                        
  |==================================================================================                                                |  63%
  |                                                                                                                                        
  |===================================================================================                                               |  63%
  |                                                                                                                                        
  |===================================================================================                                               |  64%
  |                                                                                                                                        
  |====================================================================================                                              |  64%
  |                                                                                                                                        
  |====================================================================================                                              |  65%
  |                                                                                                                                        
  |=====================================================================================                                             |  65%
  |                                                                                                                                        
  |=====================================================================================                                             |  66%
  |                                                                                                                                        
  |======================================================================================                                            |  66%
  |                                                                                                                                        
  |=======================================================================================                                           |  67%
  |                                                                                                                                        
  |========================================================================================                                          |  67%
  |                                                                                                                                        
  |========================================================================================                                          |  68%
  |                                                                                                                                        
  |=========================================================================================                                         |  68%
  |                                                                                                                                        
  |=========================================================================================                                         |  69%
  |                                                                                                                                        
  |==========================================================================================                                        |  69%
  |                                                                                                                                        
  |==========================================================================================                                        |  70%
  |                                                                                                                                        
  |===========================================================================================                                       |  70%
  |                                                                                                                                        
  |============================================================================================                                      |  70%
  |                                                                                                                                        
  |============================================================================================                                      |  71%
  |                                                                                                                                        
  |=============================================================================================                                     |  71%
  |                                                                                                                                        
  |=============================================================================================                                     |  72%
  |                                                                                                                                        
  |==============================================================================================                                    |  72%
  |                                                                                                                                        
  |==============================================================================================                                    |  73%
  |                                                                                                                                        
  |===============================================================================================                                   |  73%
  |                                                                                                                                        
  |================================================================================================                                  |  74%
  |                                                                                                                                        
  |=================================================================================================                                 |  74%
  |                                                                                                                                        
  |=================================================================================================                                 |  75%
  |                                                                                                                                        
  |==================================================================================================                                |  75%
  |                                                                                                                                        
  |==================================================================================================                                |  76%
  |                                                                                                                                        
  |===================================================================================================                               |  76%
  |                                                                                                                                        
  |====================================================================================================                              |  77%
  |                                                                                                                                        
  |=====================================================================================================                             |  77%
  |                                                                                                                                        
  |=====================================================================================================                             |  78%
  |                                                                                                                                        
  |======================================================================================================                            |  78%
  |                                                                                                                                        
  |======================================================================================================                            |  79%
  |                                                                                                                                        
  |=======================================================================================================                           |  79%
  |                                                                                                                                        
  |=======================================================================================================                           |  80%
  |                                                                                                                                        
  |========================================================================================================                          |  80%
  |                                                                                                                                        
  |=========================================================================================================                         |  80%
  |                                                                                                                                        
  |=========================================================================================================                         |  81%
  |                                                                                                                                        
  |==========================================================================================================                        |  81%
  |                                                                                                                                        
  |==========================================================================================================                        |  82%
  |                                                                                                                                        
  |===========================================================================================================                       |  82%
  |                                                                                                                                        
  |===========================================================================================================                       |  83%
  |                                                                                                                                        
  |============================================================================================================                      |  83%
  |                                                                                                                                        
  |=============================================================================================================                     |  84%
  |                                                                                                                                        
  |==============================================================================================================                    |  84%
  |                                                                                                                                        
  |==============================================================================================================                    |  85%
  |                                                                                                                                        
  |===============================================================================================================                   |  85%
  |                                                                                                                                        
  |===============================================================================================================                   |  86%
  |                                                                                                                                        
  |================================================================================================================                  |  86%
  |                                                                                                                                        
  |================================================================================================================                  |  87%
  |                                                                                                                                        
  |=================================================================================================================                 |  87%
  |                                                                                                                                        
  |==================================================================================================================                |  87%
  |                                                                                                                                        
  |==================================================================================================================                |  88%
  |                                                                                                                                        
  |===================================================================================================================               |  88%
  |                                                                                                                                        
  |===================================================================================================================               |  89%
  |                                                                                                                                        
  |====================================================================================================================              |  89%
  |                                                                                                                                        
  |====================================================================================================================              |  90%
  |                                                                                                                                        
  |=====================================================================================================================             |  90%
  |                                                                                                                                        
  |======================================================================================================================            |  91%
  |                                                                                                                                        
  |=======================================================================================================================           |  91%
  |                                                                                                                                        
  |=======================================================================================================================           |  92%
  |                                                                                                                                        
  |========================================================================================================================          |  92%
  |                                                                                                                                        
  |========================================================================================================================          |  93%
  |                                                                                                                                        
  |=========================================================================================================================         |  93%
  |                                                                                                                                        
  |==========================================================================================================================        |  93%
  |                                                                                                                                        
  |==========================================================================================================================        |  94%
  |                                                                                                                                        
  |===========================================================================================================================       |  94%
  |                                                                                                                                        
  |===========================================================================================================================       |  95%
  |                                                                                                                                        
  |============================================================================================================================      |  95%
  |                                                                                                                                        
  |============================================================================================================================      |  96%
  |                                                                                                                                        
  |=============================================================================================================================     |  96%
  |                                                                                                                                        
  |==============================================================================================================================    |  97%
  |                                                                                                                                        
  |===============================================================================================================================   |  97%
  |                                                                                                                                        
  |===============================================================================================================================   |  98%
  |                                                                                                                                        
  |================================================================================================================================  |  98%
  |                                                                                                                                        
  |================================================================================================================================  |  99%
  |                                                                                                                                        
  |================================================================================================================================= |  99%
  |                                                                                                                                        
  |================================================================================================================================= | 100%
  |                                                                                                                                        
  |==================================================================================================================================| 100%&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wi_original &amp;lt;- wi
plot(wi)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/tigris%20shapefile-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We’ll then port some code from the &lt;code&gt;hexmapr&lt;/code&gt; github README:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(hexmapr)
wi_details &amp;lt;- get_shape_details(wi)
wi@data$xcentroid &amp;lt;- coordinates(wi)[,1]
wi@data$ycentroid &amp;lt;- coordinates(wi)[,2]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’re going for the closest shapefile match, preferring a final shape than looks like the outline of the state than one with appropriate placement of counties - there is rarely a perfect grid match. So let’s test a whole bunch:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# hexagon - red border for the 28th seed
png(file = &amp;quot;/home/michael/Documents/mikeleeco.github.com/static/img/hexGridWisconsin.png&amp;quot;, width = 700, height = 500)
par(mfrow=c(7,5), mar = c(0,1,2,1))
for (i in 1:35){
  new_cells &amp;lt;-  calculate_cell_size(wi, wi_details,0.03, &amp;#39;hexagonal&amp;#39;, i)
  if(i == 28) {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;), border = &amp;quot;red&amp;quot;)
  } else {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;))
  }
}

# squares - red border for the 7th seed
png(file = &amp;quot;/home/michael/Documents/mikeleeco.github.com/static/img/squareGridWisconsin.png&amp;quot;, width = 700, height = 500)
par(mfrow=c(7,5), mar = c(0,1,2,1))
for (i in 1:35){
  new_cells &amp;lt;-  calculate_cell_size(wi, wi_details,0.03, &amp;#39;regular&amp;#39;, i)
  if(i == 7) {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;), border = &amp;quot;red&amp;quot;)
  } else {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;))
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/hexGridWisconsin.png&#34; alt=&#34;hex grid options&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;hex grid options&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/squareGridWisconsin.png&#34; alt=&#34;square grid options&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;square grid options&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;I like the look of the 28th hexagon grid, and the 7th square grid. Let’s take those and assign the polygons to a new &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;, then fortify .&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(ggplot2)
clean &amp;lt;- function(shape){
  shape@data$id = rownames(shape@data)
  shape.points = fortify(shape, region=&amp;quot;id&amp;quot;)
  shape.df = left_join(shape.points, shape@data, by=&amp;quot;id&amp;quot;)
}

new_cells_hex &amp;lt;-  calculate_cell_size(wi_original, wi_details,0.03, &amp;#39;hexagonal&amp;#39;, 28)
resulthex &amp;lt;- assign_polygons(wi_original,new_cells_hex)
result_df_hex &amp;lt;- clean(resulthex)

new_cells_square &amp;lt;-  calculate_cell_size(wi_original, wi_details,0.03, &amp;#39;regular&amp;#39;, 7)
resultsquare &amp;lt;- assign_polygons(wi_original,new_cells_square)
result_df_square &amp;lt;- clean(resultsquare)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now that we’ve got our modified &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;s - covered to a dataframe for use with ggplot2 - we can plot the result using &lt;code&gt;geom_polygon&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(viridis)
library(extrafont)
loadfonts()
theme_open_sans &amp;lt;- theme(text=element_text(family=&amp;quot;Open Sans&amp;quot;), plot.title = element_text(family = &amp;quot;Open Sans Semibold&amp;quot;, size = 24), plot.subtitle = element_text(family = &amp;quot;Open Sans Light&amp;quot;,size = 14), legend.title = element_text(family=&amp;quot;Open Sans Semibold&amp;quot;))
hexplot &amp;lt;- ggplot(result_df_hex) +
  geom_polygon(aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
  geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;white&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
  scale_fill_viridis() +
  guides(fill=FALSE) +
  theme_void() + theme_open_sans

hexplot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/square%20and%20hex%20plots%20of%20WI-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;squareplot &amp;lt;- ggplot(result_df_square) +
  geom_polygon(aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
  geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;white&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
  scale_fill_viridis() +
  guides(fill=FALSE) +
  theme_void() + theme_open_sans

squareplot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/square%20and%20hex%20plots%20of%20WI-2.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;I saw on twitter that &lt;code&gt;sf&lt;/code&gt; can now be used natively, so I gave that I try as well. First convert the &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt; to a simple feature (&lt;code&gt;sf&lt;/code&gt;), then plot the resultant object using &lt;code&gt;geom_sf&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sfResultSquare &amp;lt;- st_as_sf(resultsquare)
sfResultHex &amp;lt;- st_as_sf(resulthex)
class(sfResultHex)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;sf&amp;quot;         &amp;quot;data.frame&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sfHexPlot &amp;lt;-ggplot(sfResultHex) +
    geom_sf(aes(fill = as.numeric(ALAND)), color = &amp;quot;transparent&amp;quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;white&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
    scale_fill_viridis() +
    guides(fill=FALSE) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())

sfHexPlot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/hexgrid%20with%20sf-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cool to know that’s possible! Let’s use some more novel data than land area. Building off of a previous post mapping Wisconsin presidential election results, let’s map vote totals to our new gridmaps.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(stringr)
library(tidyr)
all_results &amp;lt;- read.csv(&amp;quot;https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv&amp;quot;, stringsAsFactors = FALSE)

wisconsin &amp;lt;- all_results %&amp;gt;% 
  filter(str_detect(fips, &amp;quot;^55&amp;quot;))

wisconsin_spread &amp;lt;- wisconsin %&amp;gt;% 
  filter(cand %in% c(&amp;quot;Donald Trump&amp;quot;, &amp;quot;Hillary Clinton&amp;quot;)) %&amp;gt;%
  select(fips, cand, votes, total_votes) %&amp;gt;%
  spread(cand, votes)

wisconsin_spread &amp;lt;- wisconsin_spread %&amp;gt;% mutate(voteDiff = `Donald Trump` - `Hillary Clinton`,
                                                pctDiff = `Donald Trump`/total_votes - `Hillary Clinton`/total_votes,
                                                weight = total_votes/ sum(total_votes))
wisconsin_spread$weight &amp;lt;- ifelse(wisconsin_spread$pctDiff &amp;gt; 0 , -wisconsin_spread$weight, wisconsin_spread$weight)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can create some custom breaks to give counties with higher vote totals more prominence in the figure, then merge these onto our hex and square &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wisconsin_spread$breaks &amp;lt;- cut(wisconsin_spread$weight,
                               breaks = c(-1, -.1, -0.05, -0.01, 0, 0.01, .05, .1, 1),
                               labels = c(&amp;quot;R   More than 10 Percent&amp;quot;, &amp;quot;R   5 to 10 Percent&amp;quot;, &amp;quot;R   1 to 5 Percent&amp;quot;, &amp;quot;R   Less than 1 Percent&amp;quot;, 
                                          &amp;quot;D   Less than 1 Percent&amp;quot;,&amp;quot;D   1 to 5 Percent&amp;quot;, &amp;quot;D   5 to 10 Percent&amp;quot;, &amp;quot;D   More than 10 Percent&amp;quot;))
wiHex &amp;lt;- merge(result_df_hex, wisconsin_spread, by.x = &amp;quot;GEOID&amp;quot;, by.y = &amp;quot;fips&amp;quot;)
wiSquare &amp;lt;- merge(result_df_square, wisconsin_spread, by.x = &amp;quot;GEOID&amp;quot;, by.y = &amp;quot;fips&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Once we’ve got our data sets finalized, figures are created usng &lt;code&gt;geom_polygon&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(RColorBrewer)

wiHexPlot &amp;lt;- ggplot(wiHex) +
    geom_polygon(aes(x=long, y=lat, fill=breaks, group = group), color = &amp;quot;#f5f5f5&amp;quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;black&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
    scale_fill_manual(name = &amp;quot;Portion of WI Vote&amp;quot;, values = brewer.pal(8, &amp;quot;RdBu&amp;quot;), drop = FALSE) +
    guides(alpha=FALSE) +
    ggtitle(label = &amp;quot;2016 Presidential Results by Wisconsin Counties&amp;quot;, subtitle = &amp;quot;59 of 72 Wisconsin counties leaned Republican, while the only two counties with\nmore than 10 percent of the state&amp;#39;s votes totaled more Democratic votes&amp;quot;) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +   
    theme_open_sans

wiHexPlot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/join%20election%20results%20to%20sf%20object-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wiSquarePlot &amp;lt;- ggplot(wiSquare) +
    geom_polygon(aes(x=long, y=lat, fill=breaks, group = group), color = &amp;quot;#f5f5f5&amp;quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;black&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
    scale_fill_manual(name = &amp;quot;Percentage of WI Vote Total&amp;quot;, values = brewer.pal(8, &amp;quot;RdBu&amp;quot;), drop = FALSE) +
    guides(alpha=FALSE) +
    ggtitle(label = &amp;quot;2016 Presidential Results by Wisconsin Counties&amp;quot;, subtitle = &amp;quot;59 of 72 Wisconsin counties leaned Republican, while the only two counties with\nmore than 10 percent of the state&amp;#39;s votes totaled more Democratic votes&amp;quot;) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +   
    theme_open_sans

wiSquarePlot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/join%20election%20results%20to%20sf%20object-2.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>