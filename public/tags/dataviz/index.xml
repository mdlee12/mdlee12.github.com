<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dataviz on Michael Lee</title>
    <link>/tags/dataviz/index.xml</link>
    <description>Recent content in Dataviz on Michael Lee</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <managingEditor>mdlee12@gmail.com (Michael Lee)</managingEditor>
    <webMaster>mdlee12@gmail.com (Michael Lee)</webMaster>
    <atom:link href="/tags/dataviz/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>R Animation Tip: Creating Pauses</title>
      <link>/posts/2019-02-23-creating-pauses-in-r-animations/</link>
      <pubDate>Sat, 23 Feb 2019 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/posts/2019-02-23-creating-pauses-in-r-animations/</guid>
      <description>&lt;div id=&#34;mastering-animation-in-r&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Mastering Animation in R&lt;/h2&gt;
&lt;p&gt;Over the last couple years I’ve developed a multitude of animations using R. During this process I’ve learned quite a bit about R graphics, gpplot2, and useful techniques in animation. In fact I presented on methods for animation in R at satRdays DC - &lt;a href=&#34;http://bit.ly/animateDC&#34;&gt;slides available here&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;div class=&#34;containerYouTube&#34;&gt;
&lt;iframe src=&#34;https://www.youtube.com/embed/glbFxRbqGWk&#34; frameborder=&#34;0&#34; allowfullscreen class=&#34;video&#34;&gt;
&lt;/iframe&gt;
&lt;/div&gt;
&lt;hr&gt;
&lt;p&gt;One simple technique to improving animations is the addition of pauses. Pauses are an effective method of capturing the viewer’s attention and driving home the main message of an animation. Pausing at the end of an animation (before it loops) offers the viewer the full scope of the visualization, and pauses during the animation can be used to emphasize key data points.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Let’s walk through creating a pause in R.&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;creating-pauses-in-r---libraries-and-data-reshaping&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Creating Pauses in R - Libraries and Data Reshaping&lt;/h2&gt;
&lt;p&gt;We’ll use the &lt;code&gt;txhousing&lt;/code&gt; data set in the &lt;code&gt;ggplot2&lt;/code&gt; package to demonstrate - this data set contains information regarding the housing market in Texas provided by the &lt;a href=&#34;http://recenter.tamu.edu/&#34;&gt;TAMU real estate center&lt;/a&gt;. The animation will plot the median sale price of two cities - Abilene and Amarillo - from 2000 to 2015.&lt;/p&gt;
&lt;p&gt;In my satuRdays DC presentation I covered the steps taken to develop an R animation:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Interpolate your data&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Structure your data to create frames that move across the dimension of interest&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Determine plot aspects that require consistency across the animation (annotations, scales, legends, etc)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Append and export the frames&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The variable &lt;code&gt;year&lt;/code&gt; contains the unique data values across our animation - &lt;code&gt;split&lt;/code&gt; will generate a list of data frames we can apply interpolations to using the &lt;code&gt;tweenr&lt;/code&gt; package.&lt;/p&gt;
&lt;details open&gt;
&lt;p&gt;&lt;summary&gt;R Libraries and Data Reshaping&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
library(scales)
library(extrafont)
library(dplyr)
library(tweenr)
library(lubridate)
library(animation)
library(RColorBrewer)
library(grid)
loadfonts()


# create data frame from txhousing data included in ggplot2 package
txHousingData &amp;lt;- txhousing %&amp;gt;% filter(city %in% unique(txhousing$city)[1:2] &amp;amp; month==1)
txHousingData &amp;lt;- txHousingData[,c(1,2,6)]
txHousingData$city &amp;lt;- factor(txHousingData$city, levels = c(&amp;quot;Abilene&amp;quot;,&amp;quot;Amarillo&amp;quot;), labels = c(&amp;quot;Abilene&amp;quot;,&amp;quot;Amarillo&amp;quot;))

# determine the unique data values that tweenr will iterate over (in this case year)
txList &amp;lt;- split(txHousingData,txHousingData$year)

# Apply tweenr to interpolate frames between data points
txTweenedData &amp;lt;- tween_states(txList, tweenlength= 1, statelength=0, ease=&amp;#39;linear&amp;#39;,nframes=200)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;p&gt;Since our data is arranged by year by default, it’s already structured in a fashion that moves across our dimension of interest (change over time) - so we’ve already completed the first two animation steps. Now that we’ve got our interpolated data frame &lt;code&gt;txTweenedData&lt;/code&gt; we can focus on the plot aesthetics.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;plot-aesthetics&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Plot Aesthetics&lt;/h2&gt;
&lt;details open&gt;
&lt;p&gt;&lt;summary&gt;ggplot2 Theme and Color Palette&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# plot aesthetics
theme_white &amp;lt;- theme(text = element_text(family=&amp;quot;Open Sans&amp;quot;),
                     panel.grid.major.y=element_blank(),
                     panel.grid.major.x=element_blank(),
                     panel.grid.minor.x=element_blank(),
                     panel.grid.minor.y=element_blank(),
                     axis.title.x=element_text(size=20, margin = margin(t=10)),
                     axis.title.y=element_text(size=20, margin = margin(t=10)),
                     axis.text.x=element_text(size=16),
                     axis.text.y=element_text(size=16),
                     axis.ticks = element_blank(),
                     plot.title=element_text(size=26,family = &amp;quot;Open Sans&amp;quot;,lineheight=1.15),
                     plot.subtitle=element_text(size=20, margin = margin(t=20, b = -5),hjust = -0.03, family = &amp;quot;Open Sans&amp;quot;),
                     plot.caption=element_text(size=14, margin=margin(t=15,r=-15),hjust = -.03,lineheight=1.15, family = &amp;quot;Open Sans&amp;quot;, face  = &amp;quot;italic&amp;quot;),
                     legend.position=&amp;quot;none&amp;quot;
)

# color palette
my_palette = c(&amp;quot;#3EC7F4&amp;quot;, &amp;quot;#3FA66C&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;p&gt;It’s critical to determine plot aspects that require consistency across the animation. I like to assign this information as variable objects so that it can easily update across different frames contained in the plotting code. If these aren’t explicitly noted, ggplot2 will render the defaults in their place.&lt;/p&gt;
&lt;details open&gt;
&lt;p&gt;&lt;summary&gt;Plot Axes, Labels, and Titles&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# y axis breaks and labels
yAxisBreaks &amp;lt;- seq(0, 140000, by = 20000)
yAxisLabels &amp;lt;- paste0(format(yAxisBreaks))
yAxisLimits &amp;lt;- c(0,max(yAxisBreaks)* 1.03)
yAxisLabels &amp;lt;- c(yAxisLabels[1:length(yAxisLabels)-1], paste0(&amp;quot;$&amp;quot;,yAxisLabels[length(yAxisLabels)]))

# x axis breaks and labels
xAxis &amp;lt;- seq(2000, 2015, by = 2)
xAxisBreaks &amp;lt;- xAxis
xAxisLimits &amp;lt;- c(1999.5, 2019)

# plot text
title &amp;lt;- &amp;quot;Median sale price of homes in Abilene and Amarillo, 2000 through 2015&amp;quot;
subtitle &amp;lt;- &amp;quot;&amp;quot;
caption &amp;lt;- &amp;quot;Information about the housing market in Texas provided by the TAMU real estate center, http://recenter.tamu.edu/.&amp;quot;
xLab &amp;lt;- &amp;quot;Year&amp;quot;
yLab &amp;lt;- &amp;quot;Median sale price&amp;quot;

midPoint &amp;lt;- round(max(txTweenedData$.frame) / 2)

# add adjustments for line labels
txTweenedData$LevelLabel &amp;lt;- as.character(txTweenedData$city)
txTweenedData$nudge_x &amp;lt;- ifelse(txTweenedData$LevelLabel==&amp;quot;Abilene&amp;quot;, 1.096,ifelse(txTweenedData$LevelLabel==&amp;quot;Amarillo&amp;quot;,1.233,0))
txTweenedData$nudge_y &amp;lt;- 0&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;/div&gt;
&lt;div id=&#34;creating-pauses&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Creating Pauses&lt;/h2&gt;
&lt;p&gt;Finally we’ve reached our R animation tip - and thankfully it’s pretty trivial! To generate pauses within an animation simply determine where the pause exists, subset your data to include that frame, and use &lt;code&gt;replicate&lt;/code&gt; and &lt;code&gt;grid.draw&lt;/code&gt; to repeat that frame n-times. For instance, say I wanted to pause at the midpoint of the animation to emphasize a point. I’d first calculate the midpoint, then ensure that my data includes all frames until that point: &lt;code&gt;subset(txTweenedData, .frame &amp;lt;= midPoint)&lt;/code&gt;.&lt;/p&gt;
&lt;details open&gt;
&lt;p&gt;&lt;summary&gt;Animation Code&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#calculate midpoint of the plot
midPoint &amp;lt;- round(max(txTweenedData$.frame) / 2)

g2 &amp;lt;- ggplot(data = subset(txTweenedData, .frame &amp;lt;= midPoint), aes(x = year, y = median, .frame = midPoint)) +
    geom_point(data = subset(txTweenedData, .frame == min(.frame)),aes(group=city, color=city), size=5) + 
    geom_point(data = subset(txTweenedData, .frame == midPoint),aes(group=city, color=city), size=5) + 
    geom_line(aes(group=city, color=city, cumulative = TRUE, label=LevelLabel), size=2.5) +
    scale_x_continuous(labels=xAxisBreaks, expand = c(0, 0), breaks=xAxisBreaks, limits =xAxisLimits) +                     
    scale_y_continuous(labels=yAxisLabels, expand = c(0, 0), breaks=yAxisBreaks,limits = yAxisLimits)
g2&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;/posts/2019-02-23-creating-pauses-in-r-animations_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;1260&#34; class = &#34;img-responsive&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;p&gt;Once we’ve created this frame, &lt;code&gt;replicate&lt;/code&gt; and &lt;code&gt;grid.draw&lt;/code&gt; repeat that frame n-times to create a pause.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;replicate(75,grid.draw(g2))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;
&lt;p&gt;Simple as that!&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;full-animation-code-within-savegif&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full Animation Code within &lt;code&gt;saveGIF&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;(NOTE: click on the gray bars to toggle collapsing the code!)&lt;/strong&gt;&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Animation Code&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;saveGIF({
  
  # print from tue first frame to the midpoint of the figure
  for(i in 1:midPoint) {
    g1 &amp;lt;-  ggplot(data = subset(txTweenedData, .frame &amp;lt;= i), aes(x = year, y = median, .frame = i)) +
      geom_point(data = subset(txTweenedData, .frame == min(.frame)),aes(group=city, color=city), size=5) + 
      geom_line(aes(group=city, color=city, cumulative = TRUE, label=LevelLabel), size=2.5) +
      scale_x_continuous(labels=xAxisBreaks, expand = c(0, 0), breaks=xAxisBreaks, limits =xAxisLimits) +                     
      scale_y_continuous(labels=yAxisLabels, expand = c(0, 0), breaks=yAxisBreaks,limits = yAxisLimits) +
      theme_minimal() + theme_white + scale_color_manual(values=my_palette) +
      geom_text(data = subset(txTweenedData, .frame == i),aes(label =LevelLabel), size = 9, nudge_y = subset(txTweenedData, .frame == i)$nudge_y, nudge_x = subset(txTweenedData, .frame == i)$nudge_x, family = &amp;quot;Open Sans&amp;quot;, lineheight = 0.75) +
      labs(x=xLab, y=yLab, title = title, subtitle = subtitle, 
                 caption = caption)
      print(g1);  
    }
  
  # print the midpoint 75 times to create a pause
  g2 &amp;lt;- ggplot(data = subset(txTweenedData, .frame &amp;lt;= midPoint), aes(x = year, y = median, .frame = midPoint)) +
      geom_point(data = subset(txTweenedData, .frame == min(.frame)),aes(group=city, color=city), size=5) + 
      geom_point(data = subset(txTweenedData, .frame == midPoint),aes(group=city, color=city), size=5) + 
      geom_line(aes(group=city, color=city, cumulative = TRUE, label=LevelLabel), size=2.5) +
      scale_x_continuous(labels=xAxisBreaks, expand = c(0, 0), breaks=xAxisBreaks, limits =xAxisLimits) +                     
      scale_y_continuous(labels=yAxisLabels, expand = c(0, 0), breaks=yAxisBreaks,limits = yAxisLimits) +
      theme_minimal() + theme_white + scale_color_manual(values=my_palette) +
      geom_text(data = subset(txTweenedData, .frame == midPoint),aes(label =LevelLabel), size = 9, nudge_y = subset(txTweenedData, .frame == midPoint)$nudge_y, nudge_x = subset(txTweenedData, .frame == midPoint)$nudge_x, family = &amp;quot;Open Sans&amp;quot;, lineheight = 0.75) + 
      labs(x=xLab, y=yLab, title = title, subtitle = subtitle, 
                 caption = caption)

  replicate(75,grid.draw(g2))
  
  # print from tue midpoint of the figure until the last frame
  for(i in midPoint:max(txTweenedData$.frame)) {
    g3 &amp;lt;- ggplot(data = subset(txTweenedData, .frame &amp;lt;= i), aes(x = year, y = median, .frame = i)) +
      geom_point(data = subset(txTweenedData, .frame == min(.frame)),aes(group=city, color=city), size=5) + 
      geom_line(aes(group=city, color=city, cumulative = TRUE, label=LevelLabel), size=2.5) +
      scale_x_continuous(labels=xAxisBreaks, expand = c(0, 0), breaks=xAxisBreaks, limits =xAxisLimits) +                     
      scale_y_continuous(labels=yAxisLabels, expand = c(0, 0), breaks=yAxisBreaks,limits = yAxisLimits) +
      theme_minimal() + theme_white + scale_color_manual(values=my_palette) +
      geom_text(data = subset(txTweenedData, .frame == i),aes(label =LevelLabel), size = 9, nudge_y = subset(txTweenedData, .frame == i)$nudge_y, nudge_x = subset(txTweenedData, .frame == i)$nudge_x, family = &amp;quot;Open Sans&amp;quot;, lineheight = 0.75) +
      labs(x=xLab, y=yLab, title = title, subtitle = subtitle, 
                 caption = caption)
    print(g3);  }

  # print the final frame of the figure 110 times to create an ending pause 
  wholeFig &amp;lt;- ggplot(data = subset(txTweenedData, .frame &amp;lt;= i), aes(x = year, y = median, .frame = i)) +
      geom_point(data = subset(txTweenedData, .frame == min(.frame)),aes(group=city, color=city), size=5) + 
      geom_point(data = subset(txTweenedData, .frame == i),aes(group=city, color=city), size=5) +
      geom_line(aes(group=city, color=city, cumulative = TRUE, label=LevelLabel), size=2.5) +
      scale_x_continuous(labels=xAxisBreaks, expand = c(0, 0), breaks=xAxisBreaks, limits =xAxisLimits) +                     
      scale_y_continuous(labels=yAxisLabels, expand = c(0, 0), breaks=yAxisBreaks,limits = yAxisLimits) +
      theme_minimal() + theme_white + scale_color_manual(values=my_palette) +
      geom_text(data = subset(txTweenedData, .frame == i),aes(label =LevelLabel), size = 9, nudge_y = subset(txTweenedData, .frame == i)$nudge_y, nudge_x = subset(txTweenedData, .frame == i)$nudge_x, family = &amp;quot;Open Sans&amp;quot;, lineheight = 0.75) +
      labs(x=xLab, y=yLab, title = title, subtitle = subtitle, 
                 caption = caption)   
  
  replicate(110,grid.draw(wholeFig))
},movie.name=&amp;quot;/home/michael/Documents/animation_samples/txHousing/txHousing.gif&amp;quot;,interval = .02, ani.width = 1024, ani.height = 612)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;hr&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/tx_Housing.gif&#34; alt=&#34;Median sale price of homes in Abilene and Amarillo, 2000 through 2015&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Median sale price of homes in Abilene and Amarillo, 2000 through 2015&lt;/p&gt;
&lt;/div&gt;
&lt;hr&gt;
&lt;p&gt;Finally it’s smart to compress the final animation, since gifs can be unwieldy.&lt;/p&gt;
&lt;details open&gt;
&lt;p&gt;&lt;summary&gt;GIF Compression&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# compress gif
gif_compress &amp;lt;- function(ingif, outgif, show=TRUE, extra.opts=&amp;quot;&amp;quot;){
  command &amp;lt;-  sprintf(&amp;quot;gifsicle -O3 %s &amp;lt; %s &amp;gt; %s&amp;quot;, extra.opts, ingif, outgif)
  system.fun &amp;lt;- if (.Platform$OS.type == &amp;quot;windows&amp;quot;) shell else system
  if(show) message(&amp;quot;Executing: &amp;quot;, strwrap(command, exdent = 2, prefix = &amp;quot;\n&amp;quot;))
  system.fun(ifelse(.Platform$OS.type == &amp;quot;windows&amp;quot;, sprintf(&amp;quot;\&amp;quot;%s\&amp;quot;&amp;quot;, shQuote(command)), command))
}

gif_compress(&amp;quot;/home/michael/Documents/animation_samples/txHousing/txHousing.gif&amp;quot;,&amp;quot;/home/michael/Documents/animation_samples/txHousing/tx_Housing.gif&amp;quot;,extra.opts=&amp;quot;--colors 256&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;p&gt;Hope you’ve found this useful! Feel free to reach out to me on twitter with any questions or feedback - &lt;a href=&#34;https://twitter.com/mikeleeco&#34; class=&#34;uri&#34;&gt;https://twitter.com/mikeleeco&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>The Dominance of Jonathan Taylor: Wisconsin Rushers in Context</title>
      <link>/posts/2019-01-28-wisconsin-rushing-history/</link>
      <pubDate>Mon, 28 Jan 2019 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/posts/2019-01-28-wisconsin-rushing-history/</guid>
      <description>&lt;div id=&#34;hot-take-alert&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Hot Take Alert&lt;/h2&gt;
&lt;p&gt;🔥 Jonathan Taylor is on pace to be the greatest running back in Wisconsin football history 🔥&lt;/p&gt;
&lt;p&gt;
&lt;p&gt;Over the previous three decades Wisconsin has retained several elite rushers (and offensive lines) to amass several conference championships and Rose Bowl appearances. Even when acknowledging Taylor’s case as a serious Heisman candidate in each of his first two years, proclaiming him the presumptive best running back in Wisconsin football history still feels like a bold proclamation. Let’s investigate!&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;accessing-the-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Accessing the data&lt;/h2&gt;
&lt;p&gt;The first step in comparing Taylor to previous Wisconsin rushers is retrieving historical college football statistics. Single-game box scores are only available on &lt;a href=&#34;https://www.sports-reference.com/cfb/&#34;&gt;Sports-Reference&lt;/a&gt; starting in 2000 (compare the game hyperlinks for the &lt;a href=&#34;https://www.sports-reference.com/cfb/schools/wisconsin/1999-schedule.html&#34;&gt;1999&lt;/a&gt; and &lt;a href=&#34;https://www.sports-reference.com/cfb/schools/wisconsin/2000-schedule.html&#34;&gt;2000&lt;/a&gt; Wisconsin schedules), therefore, two scripts were used to aggregate player data:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;The first accesses single season statistics from 1956-2018, detailed here &lt;strong&gt;(NOTE: click on the gray bars to display the code!)&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Scraper for Yearly Rushing Data, 1956 - 2018&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(rvest)
library(ggplot2)
library(lubridate)
library(shadowtext)
library(RColorBrewer)
library(ggrepel)
library(forcats)

url &amp;lt;- &amp;quot;https://www.sports-reference.com/cfb/schools/wisconsin/&amp;quot;

rushingTable &amp;lt;- &amp;#39;#rushing_and_receiving&amp;#39;
playerIDTable &amp;lt;- paste0(rushingTable,&amp;#39; a&amp;#39;)
rushingData &amp;lt;- data.frame()

# for loop by season
for (season in 1956:1999) {
  html &amp;lt;- paste0(url,season,&amp;quot;.html&amp;quot;)

  # batting stats
  html %&amp;gt;%
    read_html %&amp;gt;%
    html_nodes(xpath = &amp;#39;//comment()&amp;#39;) %&amp;gt;%
    html_text() %&amp;gt;%
    paste(collapse=&amp;#39;&amp;#39;) %&amp;gt;%
    read_html() %&amp;gt;%
    html_node(rushingTable) %&amp;gt;%
    html_table(header = TRUE) -&amp;gt; df

  # player info
  html %&amp;gt;%
    read_html %&amp;gt;%
    html_nodes(xpath = &amp;#39;//comment()&amp;#39;) %&amp;gt;%
    html_text() %&amp;gt;%
    paste(collapse=&amp;#39;&amp;#39;) %&amp;gt;%
    read_html() %&amp;gt;%
    html_nodes(playerIDTable) %&amp;gt;%
    html_attr(name=&amp;quot;href&amp;quot;) %&amp;gt;% unlist %&amp;gt;% as.character -&amp;gt; playerIDhtml

  # clean dataframe and add team and season info
  colnames(df) &amp;lt;- df[1,]
  df &amp;lt;- df[-1, ] 
  df$season &amp;lt;- c(season)

  # remove url data
  playerIDhtml=gsub(&amp;quot;/cfb/players/&amp;quot;, &amp;quot;&amp;quot;, playerIDhtml,fixed = TRUE)
  playerID=gsub(&amp;quot;.html&amp;quot;, &amp;quot;&amp;quot;, playerIDhtml,fixed = TRUE)

  df$playerID &amp;lt;- c(playerID)

  # bind to 
  rushingData &amp;lt;- rbind(rushingData,df)
}&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;The second accesses single game statistics from 2000-2018.&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Scraper for Single Game Rushing Data, 2000 - 2018&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;urlFirst &amp;lt;- &amp;quot;https://www.sports-reference.com/cfb/schools/wisconsin/&amp;quot;

urlSecond &amp;lt;- &amp;quot;https://www.sports-reference.com&amp;quot;

offenseYear &amp;lt;- &amp;quot;#offense&amp;quot;
gameDate &amp;lt;- paste0(offenseYear,&amp;#39; a&amp;#39;)

urls &amp;lt;- c()

for (season in 2000:2018) {
  html &amp;lt;- paste0(urlFirst,season,&amp;quot;/gamelog/&amp;quot;)

  # player info
  html %&amp;gt;%
    read_html() %&amp;gt;%
    html_nodes(gameDate) %&amp;gt;%
    html_attr(name=&amp;quot;href&amp;quot;) %&amp;gt;% unlist %&amp;gt;% as.character -&amp;gt; playerIDhtml

  playerIDhtml &amp;lt;- grep(&amp;quot;boxscores&amp;quot;,x = playerIDhtml,value = TRUE)
  
  html2 &amp;lt;- paste0(urlSecond,playerIDhtml)

  # bind to 
  urls &amp;lt;- c(urls,html2)
}


rushingDataGames &amp;lt;- data.frame()


# for loop by season
for (links in urls) {

  # batting stats
  links %&amp;gt;%
    read_html %&amp;gt;%
    html_nodes(xpath = &amp;#39;//comment()&amp;#39;) %&amp;gt;%
    html_text() %&amp;gt;%
    paste(collapse=&amp;#39;&amp;#39;) %&amp;gt;%
    read_html() %&amp;gt;%
    html_node(rushingTable) %&amp;gt;%
    html_table(header = TRUE) -&amp;gt; df


  # clean dataframe and add team and season info
  colnames(df) &amp;lt;- paste0(colnames(df), df[1,])
  df &amp;lt;- df[-1, ] 
  df &amp;lt;- df %&amp;gt;% filter(!School %in% c(&amp;quot;School&amp;quot;, NA, &amp;quot;&amp;quot;))
  df$gameDate &amp;lt;- gsub(pattern = paste(c(&amp;quot;https://www.sports-reference.com/cfb/boxscores/&amp;quot;), collapse = &amp;quot;|&amp;quot;),replacement =  &amp;quot;&amp;quot;, x = links)
  df$gameDate &amp;lt;- substr(df$gameDate ,1,10)

  # player info
  links %&amp;gt;%
    read_html %&amp;gt;%
    html_nodes(xpath = &amp;#39;//comment()&amp;#39;) %&amp;gt;%
    html_text() %&amp;gt;%
    paste(collapse=&amp;#39;&amp;#39;) %&amp;gt;%
    read_html() %&amp;gt;%
    html_nodes(playerIDTable) %&amp;gt;%
    html_attr(name=&amp;quot;href&amp;quot;) %&amp;gt;% unlist %&amp;gt;% as.character -&amp;gt; playerIDhtml

  playerIDhtml &amp;lt;- grep(&amp;quot;players&amp;quot;,x = playerIDhtml,value = TRUE)

  # remove url data
  playerIDhtml=gsub(&amp;quot;/cfb/players/&amp;quot;, &amp;quot;&amp;quot;, playerIDhtml,fixed = TRUE)
  playerID=gsub(&amp;quot;.html&amp;quot;, &amp;quot;&amp;quot;, playerIDhtml,fixed = TRUE)

  if(links == &amp;quot;https://www.sports-reference.com/cfb/boxscores/2013-09-28-ohio-state.html&amp;quot;) {
    playerID &amp;lt;- c(playerID[1:11], &amp;quot;corey-brown-2&amp;quot;, playerID[12:14])
  }

  if(links == &amp;quot;https://www.sports-reference.com/cfb/boxscores/2013-11-23-minnesota.html&amp;quot;) {
    playerID &amp;lt;- c(playerID[1:11], &amp;quot;donovahn-jones-1&amp;quot;, playerID[12:15])
  }
 

  df$playerID &amp;lt;- c(playerID)

  # bind to 
  rushingDataGames &amp;lt;- rbind(rushingDataGames,df)
}&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;p&gt;Instead of re-running the scrapers, the full data as an &lt;strong&gt;.Rdata&lt;/strong&gt; file can be accessed through these two links: &lt;a href=&#34;https://mikelee.co/data/gameRushingData.rdata&#34;&gt;Single Game Rushing Data, 2000 - 2018&lt;/a&gt; and &lt;a href=&#34;https://mikelee.co/data/yearRushingData.rdata&#34;&gt;Yearly Rushing Data, 1968 - 2018&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;analysis&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Analysis&lt;/h1&gt;
&lt;p&gt;In order to generate visualizations we’ll first need to complete some slight reshaping and data cleanup. Since the box scores don’t contain much supplementary information, we’ll instead construct a few dplyr &lt;code&gt;filter&lt;/code&gt; conditions to create our data set of best rushers in Wisconsin history.&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Data Reshaping and Cleanup&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rushingDataGames &amp;lt;- readRDS(&amp;quot;/home/michael/Documents/mikeleeco.github.com/static/data/gameRushingData.rdata&amp;quot;)

rushingData &amp;lt;- readRDS(&amp;quot;/home/michael/Documents/mikeleeco.github.com/static/data/yearRushingData.rdata&amp;quot;)

rushingDataGames$gameDate &amp;lt;- ymd(rushingDataGames$gameDate)

rushingDataGames &amp;lt;- rushingDataGames %&amp;gt;% filter(School == &amp;quot;Wisconsin&amp;quot;)

rushingDataGames$gameNo &amp;lt;- 1

rushingDataGames$RushingYds &amp;lt;- ifelse(is.na(rushingDataGames$RushingYds) | rushingDataGames$RushingYds == &amp;quot;&amp;quot;, 0, rushingDataGames$RushingYds)
rushingDataGames$RushingAtt &amp;lt;- ifelse(is.na(rushingDataGames$RushingAtt) | rushingDataGames$RushingAtt == &amp;quot;&amp;quot;, 0, rushingDataGames$RushingAtt)

dat &amp;lt;- rushingDataGames %&amp;gt;%
    arrange(playerID, gameDate) %&amp;gt;%
    group_by(playerID) %&amp;gt;%
    mutate(gameNo = cumsum(gameNo),roll_sum_att = cumsum(RushingAtt),roll_sum_yards = cumsum(RushingYds))


dat &amp;lt;- dat %&amp;gt;%
    arrange(playerID, gameDate) %&amp;gt;%
    group_by(playerID) %&amp;gt;%
    mutate()

x &amp;lt;- dat %&amp;gt;% group_by(playerID) %&amp;gt;% filter(gameDate == max(gameDate, na.rm = TRUE))

xx &amp;lt;- x %&amp;gt;% filter(!is.na(roll_sum_yards) &amp;amp; roll_sum_yards &amp;gt; 0)

dat$gameDate &amp;lt;- ymd(dat$gameDate)

xScale &amp;lt;- as.Date(as.character(c(2000:2019)),&amp;quot;%Y&amp;quot;)

dat &amp;lt;- dat %&amp;gt;% group_by(playerID) %&amp;gt;% filter(max(as.numeric(gameNo), na.rm = TRUE) &amp;gt; 10 &amp;amp; max(as.numeric(roll_sum_yards), na.rm = TRUE) &amp;gt; 0 &amp;amp; max(year(gameDate), na.rm = TRUE) &amp;gt; 2000)


rushingData$Rk &amp;lt;- NULL
rushingData$School &amp;lt;- &amp;quot;Wisconsin&amp;quot;
rushingData$gameNo &amp;lt;- NA
rushingData$roll_sum_yards &amp;lt;- NA
rushingData$gameDate &amp;lt;- rushingData$season

colnames(rushingData) &amp;lt;- c(&amp;quot;Player&amp;quot;,  &amp;quot;RushingAtt&amp;quot;, &amp;quot;RushingYds&amp;quot;, &amp;quot;RushingAvg&amp;quot;, 
&amp;quot;RushingTD&amp;quot;, &amp;quot;ReceivingRec&amp;quot;, &amp;quot;ReceivingYds&amp;quot;, &amp;quot;ReceivingAvg&amp;quot;, 
&amp;quot;ReceivingTD&amp;quot;, &amp;quot;ScrimmagePlays&amp;quot;, &amp;quot;ScrimmageYds&amp;quot;, &amp;quot;ScrimmageAvg&amp;quot;, 
&amp;quot;ScrimmageTD&amp;quot;, &amp;quot;gameDate&amp;quot;, &amp;quot;playerID&amp;quot;,&amp;quot;School&amp;quot;, &amp;quot;gameNo&amp;quot;, &amp;quot;roll_sum&amp;quot;, 
&amp;quot;season&amp;quot;)


rushingData$RushingYds &amp;lt;- ifelse(is.na(rushingData$RushingYds) | rushingData$RushingYds == &amp;quot;&amp;quot;, 0, rushingData$RushingYds)
rushingData$RushingAtt &amp;lt;- ifelse(is.na(rushingData$RushingAtt) | rushingData$RushingAtt == &amp;quot;&amp;quot;, 0, rushingData$RushingAtt)



rushingData2 &amp;lt;- rushingData %&amp;gt;% group_by(playerID, Player, season) %&amp;gt;% summarise(RushingAtt = sum(as.numeric(RushingAtt),na.rm = TRUE), RushingYds = sum(as.numeric(RushingYds),na.rm = TRUE)) %&amp;gt;% filter(max(as.numeric(RushingYds), na.rm = TRUE) &amp;gt; 1000)


z2 &amp;lt;- rushingData2 %&amp;gt;%
    arrange(playerID) %&amp;gt;%
    group_by(playerID) %&amp;gt;%
    mutate(gameNo = cumsum(season),roll_sum_att = cumsum(RushingAtt),roll_sum_yards = cumsum(RushingYds))


z3 &amp;lt;- z2[!duplicated(z2$playerID), ]
z3$season &amp;lt;- z3$season - 1
z3$gameNo &amp;lt;- z3$season
z3$RushingYds &amp;lt;- 0
z3$roll_sum_yards &amp;lt;- 0

z2 &amp;lt;- bind_rows(z2, z3)

z2 &amp;lt;- z2 %&amp;gt;%
    arrange(playerID, season, RushingYds) 

z2 &amp;lt;- z2 %&amp;gt;% group_by(playerID, season) %&amp;gt;% add_tally() %&amp;gt;% ungroup()%&amp;gt;% group_by(playerID) %&amp;gt;% mutate(seasonNo = cumsum(n))

leadingRushersGame &amp;lt;- c(&amp;quot;montee-ball-1&amp;quot;, &amp;quot;melvin-gordon-1&amp;quot;, &amp;quot;anthony-davis-3&amp;quot;, &amp;quot;james-white-2&amp;quot;,
                        &amp;quot;jonathan-taylor-1&amp;quot;, &amp;quot;pj-hill-1&amp;quot;, &amp;quot;john-clay-1&amp;quot;, &amp;quot;corey-clement-1&amp;quot;, &amp;quot;brian-calhoun-1&amp;quot;)

leadingRushersSeason &amp;lt;- c(&amp;quot;anthony-davis-3&amp;quot;, &amp;quot;billy-marek-1&amp;quot;, &amp;quot;brent-moss-1&amp;quot;, &amp;quot;brian-calhoun-1&amp;quot;, 
                          &amp;quot;carl-mccullough-2&amp;quot;, &amp;quot;corey-clement-1&amp;quot;, &amp;quot;james-white-2&amp;quot;, &amp;quot;john-clay-1&amp;quot;, 
                          &amp;quot;jonathan-taylor-1&amp;quot;, &amp;quot;larry-emery-1&amp;quot;, &amp;quot;melvin-gordon-1&amp;quot;, &amp;quot;michael-bennett-1&amp;quot;, 
                          &amp;quot;montee-ball-1&amp;quot;, &amp;quot;pj-hill-1&amp;quot;, &amp;quot;ron-dayne-1&amp;quot;, &amp;quot;rufus-ferguson-1&amp;quot;, 
                          &amp;quot;terrell-fletcher-1&amp;quot;)


labelDat &amp;lt;- subset(z2, playerID %in% z2$playerID &amp;amp; playerID %in% leadingRushersSeason) %&amp;gt;% group_by(Player) %&amp;gt;% slice(which.max(roll_sum_yards))
labelDat$roll_sum_yards &amp;lt;- ifelse(labelDat$playerID == &amp;quot;terrell-fletcher-1&amp;quot;, labelDat$roll_sum_yards - 60,
            ifelse(labelDat$playerID == &amp;quot;brent-moss-1&amp;quot;, labelDat$roll_sum_yards + 60,labelDat$roll_sum_yards))

z4 &amp;lt;- z2 %&amp;gt;% group_by(playerID) %&amp;gt;%  top_n(2, RushingYds) %&amp;gt;% mutate(seasonNo = cumsum(n),roll_sum_att = cumsum(RushingAtt),roll_sum_yards = cumsum(RushingYds), meanydsperattempt = roll_sum_yards/roll_sum_att)


z3 &amp;lt;- z4[!duplicated(z4$playerID), ]
z3$seasonNo &amp;lt;- z3$seasonNo - 1
z3$gameNo &amp;lt;- z3$seasonNo
z3$RushingYds &amp;lt;- 0
z3$roll_sum_yards &amp;lt;- 0
z3$roll_sum_att &amp;lt;- 0
z4 &amp;lt;- bind_rows(z4, z3)

z5 &amp;lt;- z4 %&amp;gt;%
    arrange(playerID, season, RushingYds) %&amp;gt;%
    filter(playerID != &amp;quot;brian-calhoun-1&amp;quot; &amp;amp; seasonNo == 2)

z5$Player &amp;lt;- gsub(&amp;quot; &amp;quot;, &amp;quot;\n&amp;quot;, z5$Player)

z5$playerOrder &amp;lt;- fct_reorder(z5$Player,z5$roll_sum_yards)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;ggplot2 Theme&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;themeWisconsin &amp;lt;- function () { 
    theme_bw(base_size=13, base_family=&amp;quot;Open Sans&amp;quot;) %+replace% 
        theme(
            axis.line = element_line(colour = &amp;quot;#f4f4f4&amp;quot;, size = 1.2),
            panel.border = element_blank(),
            panel.background = element_blank(),
            panel.grid.minor = element_blank(),
            panel.grid.major = element_blank(),
            plot.title =  element_text(size = 20, hjust = 0, margin = unit(c(5, 5, 5, 5), &amp;quot;mm&amp;quot;)),
            axis.title.x = element_text(size = 15, hjust = .5, margin = unit(c(5, 5, 5, 5), &amp;quot;mm&amp;quot;)),
            axis.title.y =  element_text(size = 15, hjust = .5, angle = 90, margin = unit(c(5, 5, 5, 5), &amp;quot;mm&amp;quot;)),
            plot.background = element_rect(fill=&amp;quot;white&amp;quot;, colour=NA), 
            legend.background = element_rect(fill=&amp;quot;transparent&amp;quot;, colour=NA),
            legend.key = element_rect(fill=&amp;quot;transparent&amp;quot;, colour=NA),
            axis.ticks = element_blank()
        )
}
cols &amp;lt;- c(&amp;quot;#a6cee3&amp;quot;,&amp;quot;#1f78b4&amp;quot;,&amp;quot;#b2df8a&amp;quot;,&amp;quot;#33a02c&amp;quot;,&amp;quot;#fb9a99&amp;quot;,&amp;quot;#e31a1c&amp;quot;,&amp;quot;#ff7f00&amp;quot;,&amp;quot;#cab2d6&amp;quot;,&amp;quot;#6a3d9a&amp;quot;,&amp;quot;#b15928&amp;quot;)
getPallette = colorRampPalette(cols)

leftAlignPlot &amp;lt;- function (plot) { 

  g &amp;lt;- ggplotGrob(plot)

  g$layout$l[g$layout$name == &amp;quot;title&amp;quot;] &amp;lt;- 4
  g$layout$clip[g$layout$name==&amp;quot;panel&amp;quot;] &amp;lt;- &amp;quot;off&amp;quot;
  g$layout$z[g$layout$name==&amp;quot;panel&amp;quot;] = 17
  grid::grid.draw(g)
}&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Comparing Wisconsin Running Back Rushing Production by Game, 2000 - 2018&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;figure2 &amp;lt;- ggplot() +
    geom_point(data = subset(dat, playerID %in% xx$playerID), aes(gameDate, roll_sum_yards, group = playerID), color = &amp;quot;lightgrey&amp;quot;, alpha = .7) +
    geom_point(data = subset(dat, playerID %in% xx$playerID &amp;amp; playerID %in% leadingRushersGame), aes(gameDate, roll_sum_yards, group = playerID), color = &amp;quot;#c5050c&amp;quot;, alpha = 1) +
    geom_line(data = subset(dat, playerID %in% xx$playerID), aes(gameDate, roll_sum_yards, group = playerID), color = &amp;quot;lightgrey&amp;quot;, alpha = .7) +
    geom_line(data = subset(dat, playerID %in% xx$playerID &amp;amp; playerID %in% leadingRushersGame), aes(gameDate, roll_sum_yards, group = playerID), color = &amp;quot;#c5050c&amp;quot;, alpha = 1) +
    geom_shadowtext(data = subset(dat, playerID %in% xx$playerID &amp;amp; playerID %in% leadingRushersGame) %&amp;gt;% group_by(Player)%&amp;gt;% slice(which.max(roll_sum_yards)),
      aes(gameDate, roll_sum_yards, label = paste0(&amp;quot;  &amp;quot;,Player)), color = &amp;quot;black&amp;quot;, bg.colour=&amp;#39;white&amp;#39;, size = 6, hjust = 0, family = &amp;quot;Open Sans&amp;quot;, fontface = &amp;quot;bold&amp;quot;) + themeWisconsin() +
    guides(color=FALSE)  + scale_x_date(limits = ymd(c(&amp;quot;2000-04-20&amp;quot;,&amp;quot;2022-10-31&amp;quot;)),
      labels=year(ymd(c(&amp;quot;2000-8-20&amp;quot;,&amp;quot;2002-8-20&amp;quot;,&amp;quot;2004-8-20&amp;quot;,&amp;quot;2006-8-20&amp;quot;,&amp;quot;2008-8-20&amp;quot;,&amp;quot;2010-8-20&amp;quot;,&amp;quot;2012-8-20&amp;quot;,&amp;quot;2014-8-20&amp;quot;,&amp;quot;2016-8-20&amp;quot;,&amp;quot;2018-8-20&amp;quot;))),
      breaks=ymd(c(&amp;quot;2000-8-20&amp;quot;,&amp;quot;2002-8-20&amp;quot;,&amp;quot;2004-8-20&amp;quot;,&amp;quot;2006-8-20&amp;quot;,&amp;quot;2008-8-20&amp;quot;,&amp;quot;2010-8-20&amp;quot;,&amp;quot;2012-8-20&amp;quot;,&amp;quot;2014-8-20&amp;quot;,&amp;quot;2016-8-20&amp;quot;,&amp;quot;2018-8-20&amp;quot;)), expand = c(0, 0)) +
      scale_y_continuous(expand = c(0, 0), limits = c(-40, 5500)) + 
      labs(title = &amp;quot;Figure 2: Cumulative Rushing Yards by Game for Notable Wisconsin Running Backs, 2000 - 2018&amp;quot;, y = &amp;quot;Rushing Yards&amp;quot;,  x = &amp;quot;Date&amp;quot;)

figure3 &amp;lt;- ggplot() +
    geom_point(data = subset(dat, playerID %in% xx$playerID), aes(gameNo, roll_sum_yards, group = playerID), color = &amp;quot;lightgrey&amp;quot;, alpha = .7) +
    geom_point(data = subset(dat, playerID %in% xx$playerID &amp;amp; playerID %in% leadingRushersGame), aes(gameNo, roll_sum_yards, group = playerID, color = playerID), alpha = 1) +
    geom_line(data = subset(dat, playerID %in% xx$playerID), aes(gameNo, roll_sum_yards, group = playerID), color = &amp;quot;lightgrey&amp;quot;, alpha = .7) +
    geom_line(data = subset(dat, playerID %in% xx$playerID &amp;amp; playerID %in% leadingRushersGame), aes(gameNo, roll_sum_yards, group = playerID, color = playerID), alpha = 1) +
    geom_shadowtext(data = subset(dat, playerID %in% xx$playerID &amp;amp; playerID %in% leadingRushersGame) %&amp;gt;% group_by(Player)%&amp;gt;% slice(which.max(roll_sum_yards)),
                    aes(gameNo, roll_sum_yards, label = paste0(&amp;quot;  &amp;quot;,Player), color = playerID), bg.colour=&amp;#39;white&amp;#39;, size = 6, hjust = 0, family = &amp;quot;Open Sans&amp;quot;) +
    guides(color=FALSE)  + scale_x_continuous(limits = c(0,60),expand = c(0, 0)) +
    scale_y_continuous(expand = c(0, 0), limits = c(-20, 5500)) + themeWisconsin() +
    scale_color_manual(values = getPallette(length(unique(leadingRushersGame)))) + 
      labs(title = &amp;quot;Figure 3: Cumulative Rushing Yards by Game Number for Notable Wisconsin Running Backs, 2000 - 2018&amp;quot;, y = &amp;quot;Rushing Yards&amp;quot;,  x = &amp;quot;Game Number&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Comparing Wisconsin Running Backs Rushing Production by Seasonal Production, 1956 - 2018&lt;/summary&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;figure1 &amp;lt;- ggplot(data = z2, aes(season, roll_sum_yards, group = playerID)) +
    geom_point(color = &amp;quot;#c5050c&amp;quot;) +
    geom_line(color = &amp;quot;#c5050c&amp;quot;) +
    geom_text_repel(data = z2 %&amp;gt;% group_by(Player)%&amp;gt;% slice(which.max(roll_sum_yards)),
                    aes(season, roll_sum_yards, label = paste0(&amp;quot;  &amp;quot;,Player)), color = &amp;quot;black&amp;quot;, size = 6, direction = &amp;quot;y&amp;quot;, family = &amp;quot;Open Sans&amp;quot;, fontface = &amp;quot;bold&amp;quot;, hjust= 0, segment.colour = NA, point.padding = NA) +
    guides(color=FALSE) + scale_y_continuous(expand = c(0,0), limits = c(-20, 8000)) + scale_x_continuous(limits = c(1968,2028),expand = c(0, 0)) + themeWisconsin() + 
      labs(title = &amp;quot;Figure 1: Cumulative Rushing Yards by Season for Notable Wisconsin Running Backs, 1968 - 2018&amp;quot;, y = &amp;quot;Rushing Yards&amp;quot;,  x = &amp;quot;Date&amp;quot;)


figure4 &amp;lt;- ggplot() +
    geom_point(data = subset(z2, playerID %in% z2$playerID), aes(seasonNo, roll_sum_yards, group = playerID), color = &amp;quot;lightgrey&amp;quot;, alpha = .7) +
    geom_point(data = subset(z2, playerID %in% z2$playerID &amp;amp; playerID %in% leadingRushersSeason), aes(seasonNo, roll_sum_yards, group = playerID, color = playerID), alpha = 1) +
    geom_line(data = subset(z2, playerID %in% z2$playerID), aes(seasonNo, roll_sum_yards, group = playerID), color = &amp;quot;lightgrey&amp;quot;, alpha = .7) +
    geom_line(data = subset(z2, playerID %in% z2$playerID &amp;amp; playerID %in% leadingRushersSeason), aes(seasonNo, roll_sum_yards, group = playerID, color = playerID), alpha = 1) +
    geom_shadowtext(data = labelDat, aes(seasonNo, roll_sum_yards, label = paste0(&amp;quot;  &amp;quot;,Player), color = playerID), bg.colour=&amp;#39;white&amp;#39;, size = 6, hjust = 0, family = &amp;quot;Open Sans&amp;quot;) +
    guides(color=FALSE) + scale_x_continuous(labels=c(0:4), breaks=c(1:5),limits = c(1,6),expand = c(0, 0)) +
    scale_y_continuous(expand = c(0, 0), limits = c(-20, 8000)) +  themeWisconsin() +
    scale_color_manual(values = getPallette(length(unique(leadingRushersSeason)))) + 
      labs(title = &amp;quot;Figure 4: Cumulative Rushing Yards for Notable Wisconsin Running Backs by Seasons in Program&amp;quot;, y = &amp;quot;Rushing Yards&amp;quot;,  x = &amp;quot;Season&amp;quot;)

figure5 &amp;lt;- ggplot() +
    geom_col(data = z5, aes(x = playerOrder, y = roll_sum_yards), fill = &amp;quot;#c5050c&amp;quot;, alpha = .7) +
    scale_y_continuous(expand = c(0,0), limits = c(0,4500)) +
    geom_text(data = z5, aes(x = playerOrder, y = roll_sum_yards, label=format(z5$roll_sum_yards, nsmall=0, big.mark=&amp;quot;,&amp;quot;)),family = &amp;quot;Open Sans&amp;quot;, vjust=-.5) +
    guides(color=FALSE) + themeWisconsin() + 
    labs(title = &amp;quot;Figure 5: Cumulative Rushing Yards for Notable Wisconsin Running Backs in their Two Highest Rushing Seasons&amp;quot;, y = &amp;quot;Rushing Yards&amp;quot;,  x = &amp;quot;Player&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;
&lt;p&gt;Wisconsin has employed an incredible sequence of successful running backs since Barry Alvarez breathed life into the program in the early 1990s. Ron Dayne, Montee Ball, Melvin Gordon, and Taylor have each finished in the top 10 of Heisman voting - Taylor doing so twice - while also winning the Doak Walker Award for the best collegiate running back.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2019-01-28-wisconsin-rushing-history_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;2700&#34; class = &#34;img-responsive&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;As displayed in Figure 1, the &lt;em&gt;four-year&lt;/em&gt; production of Ron Dayne stands out from the recent crop of running backs. Dayne’s contributions on the field resulted in breaking the FBS career rushing mark (since eclipsed, &lt;a href=&#34;https://fivethirtyeight.com/features/why-college-footballs-new-all-time-rushing-leader-isnt-really-its-all-time-rushing-leader/&#34;&gt;controversially&lt;/a&gt;) in 1999, and he deserves some credit for establishing the class of running back commit Wisconsin is able to sign to this day.&lt;/p&gt;
&lt;div class=&#34;containerYouTube&#34;&gt;
&lt;iframe src=&#34;https://www.youtube.com/embed/jZq_KJyDIjQ?start=2055&#34; frameborder=&#34;0&#34; allowfullscreen class=&#34;video&#34;&gt;
&lt;/iframe&gt;
&lt;/div&gt;
&lt;p&gt;
&lt;p&gt;Taylor stands on the shoulders of a legacy of elite rushing prospects. Looking more closely at single game rushing data over time in Figure 2, Taylor fits in neatly with his fellow Badgers - he is equal in stature to the best recent Wisconsin running backs. It’s incredible to reflect on the 2011 data points signifying a Wisconsin team that fielded Montee Ball, James White and Melvin Gordon (albeit for only 3 games) simultaneously!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2019-01-28-wisconsin-rushing-history_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;2700&#34; class = &#34;img-responsive&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;
&lt;p&gt;When considering the rushing totals by game number is where his success has few comparisons. Figure 3 shows the cumulative rushing yards by game starting in 2000, the first year that single game data is available. Three things pop out to me:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Anthony Davis and P.J. Hill had much better careers than I recall&lt;/li&gt;
&lt;li&gt;Brian Calhoun had a monster first game as a Badger - &lt;a href=&#34;https://www.sports-reference.com/cfb/boxscores/2005-09-03-wisconsin.html&#34;&gt;258 yards rushing against Bowling Green&lt;/a&gt;!&lt;/li&gt;
&lt;li&gt;James White and Montee Ball played &lt;em&gt;a lot&lt;/em&gt; of games in their career&lt;/li&gt;
&lt;li&gt;Jonathan Taylor’s first 27 games have been unreal&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&#34;/posts/2019-01-28-wisconsin-rushing-history_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;2700&#34; class = &#34;img-responsive&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;p&gt;
&lt;p&gt;In fact, when compared to all Wisconsin rushers in their first two seasons (regardless of academic standing) Taylor’s are the most yards all time. As seen in Figure 4, it’s not particularly close!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2019-01-28-wisconsin-rushing-history_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;2700&#34; class = &#34;img-responsive&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;
&lt;p&gt;He is comfortably on pace to accrue more rushing yards than all Wisconsin running backs (aside from Ron Dayne) by the end of his junior season. If he returns for his senior season, the FBS career rushing mark might be in reach. Figure 5 displays the top two rushing seasons for notable Wisconsin running backs during their careers. The total rushing of Taylor’s freshman and sophomore campaigns stack up as the second highest total of the &lt;em&gt;any of the two best seasons&lt;/em&gt; of all Wisconsin running backs.&lt;/p&gt;
&lt;img src=&#34;/posts/2019-01-28-wisconsin-rushing-history_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;2700&#34; class = &#34;img-responsive&#34; style=&#34;display: block; margin: auto;&#34; /&gt;
&lt;p&gt;
&lt;p&gt;Over the first two seasons of his career, Taylor accumulated more rushing yards:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;than any rusher in school history over their first two years&lt;/li&gt;
&lt;li&gt;than P.J. Hill, John Clay, and Rufus Ferguson in their &lt;strong&gt;three&lt;/strong&gt; college seasons&lt;/li&gt;
&lt;li&gt;than James White, Billy Marek, Brent Moss, Terrell Fletcher, Corey Clement, Larry Emery, and Carl McCollough in their &lt;strong&gt;four&lt;/strong&gt; respective college seasons&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Jonathan Taylor has chewed up yards - and the best might still be to come.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Stacked Area Chart - US Education Enrollment</title>
      <link>/animation/2018-09-05-stacked-area-chart-enrollment/</link>
      <pubDate>Wed, 05 Sep 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2018-09-05-stacked-area-chart-enrollment/</guid>
      <description>&lt;p&gt;Linked here: &lt;a href=&#34;https://nces.ed.gov/blogs/nces/post/celebrating-150-years-of-education-data&#34; class=&#34;uri&#34;&gt;https://nces.ed.gov/blogs/nces/post/celebrating-150-years-of-education-data&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/public_Enrollment.gif&#34; alt=&#34;Enrollment in elementary, secondary, and postsecondary institutions: Selected years, 1869-70 through 2016&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Enrollment in elementary, secondary, and postsecondary institutions: Selected years, 1869-70 through 2016&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Average cumulative student loan balance for doctorate degree completers, by degree program: Selected years, 2000–2016</title>
      <link>/animation/2018-08-18-animated-faceted-line-chart-student-loan-doctors/</link>
      <pubDate>Sat, 18 Aug 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2018-08-18-animated-faceted-line-chart-student-loan-doctors/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
Between 1999–2000 &amp;amp; 2015–16, avg. &lt;a href=&#34;https://twitter.com/hashtag/StudentLoan?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#StudentLoan&lt;/a&gt; debt for medical doctorate completers increased by 97% (from $124,700 to $246,000). More &lt;a href=&#34;https://twitter.com/hashtag/stats?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#stats&lt;/a&gt; on student &lt;a href=&#34;https://twitter.com/hashtag/debt?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#debt&lt;/a&gt; here in our NEW blog: &lt;a href=&#34;https://t.co/mz1F3aI943&#34;&gt;https://t.co/mz1F3aI943&lt;/a&gt; &lt;a href=&#34;https://t.co/93mzhYkwgF&#34;&gt;pic.twitter.com/93mzhYkwgF&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/1030868436027691010?ref_src=twsrc%5Etfw&#34;&gt;August 18, 2018&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/lineEducationGridDoctorate.gif&#34; alt=&#34;Average cumulative student loan balance for doctorate degree completers, by degree program: Selected years, 2000–2016&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Average cumulative student loan balance for doctorate degree completers, by degree program: Selected years, 2000–2016&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Average cumulative student loan balance for master&#39;s degree completers, by degree program: Selected years, 2000–2016</title>
      <link>/animation/2018-08-07-animated-faceted-line-chart-student-loan-masters/</link>
      <pubDate>Tue, 07 Aug 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2018-08-07-animated-faceted-line-chart-student-loan-masters/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
DYK? Avg. &lt;a href=&#34;https://twitter.com/hashtag/StudentLoan?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#StudentLoan&lt;/a&gt; balances were higher in 2015–16 than in 1999–2000 for all master’s degree fields. Interested in &lt;a href=&#34;https://twitter.com/hashtag/StudentDebt?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#StudentDebt&lt;/a&gt; stats? Find more &lt;a href=&#34;https://twitter.com/hashtag/EdData?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#EdData&lt;/a&gt; in our NEW BLOG: &lt;a href=&#34;https://t.co/mz1F3aI943&#34;&gt;https://t.co/mz1F3aI943&lt;/a&gt; &lt;a href=&#34;https://t.co/84BvN3bqWX&#34;&gt;pic.twitter.com/84BvN3bqWX&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/1026807694731161600?ref_src=twsrc%5Etfw&#34;&gt;August 7, 2018&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/lineEducationGridMasters.gif&#34; alt=&#34;Average cumulative student loan balance for master’s degree completers, by degree program: Selected years, 2000–2016&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Average cumulative student loan balance for master’s degree completers, by degree program: Selected years, 2000–2016&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Measles Vaccination Chart D3 Replication</title>
      <link>/interactives/2018-07-01-wsj-measles-interactive/</link>
      <pubDate>Sun, 01 Jul 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/interactives/2018-07-01-wsj-measles-interactive/</guid>
      <description>&lt;style&gt;
iframe {
    border: 0;
    height: 1100px;
}

.container {
    margin-left: 20px;
    margin-right: 20px;
    padding: 0px;
}

.footer {
    margin-left: 20px;
    margin-right: 20px;
    padding: 0px;
}

&lt;/style&gt;

&lt;script src=&#34;https://d3js.org/d3.v5.min.js&#34;&gt;&lt;/script&gt;

&lt;div class=&#34;container&#34;&gt;
    &lt;div id=&#34;graphic&#34; style=&#34;width: 1500px;&#34;&gt;&lt;/div&gt;
    &lt;script type=&#34;text/javascript&#34; src=&#34;https://pym.nprapps.org/pym.v1.min.js&#34;&gt;&lt;/script&gt;
    &lt;script&gt;
        var pymParent = new pym.Parent(&#39;graphic&#39;, &#39;/js/d3samples/measles/measles.html&#39;, {});
    &lt;/script&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Average cumulative student loan balance for graduate school completers, by degree type: Selected years, 2000-2016</title>
      <link>/animation/2018-05-23-animated-line-chart-cumulative-student-loan-balance/</link>
      <pubDate>Wed, 23 May 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2018-05-23-animated-line-chart-cumulative-student-loan-balance/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
Among grad school completers in 2015–16 who took out &lt;a href=&#34;https://twitter.com/hashtag/studentloans?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#studentloans&lt;/a&gt;, the avg. balance was highest for those completing a professional doctorate ($186,600). Learn more in our NEW &lt;a href=&#34;https://twitter.com/hashtag/COE2018?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#COE2018&lt;/a&gt; Spotlight: &lt;a href=&#34;https://t.co/Yr9DzkGYMS&#34;&gt;https://t.co/Yr9DzkGYMS&lt;/a&gt; &lt;a href=&#34;https://t.co/o7AvnRRjcH&#34;&gt;pic.twitter.com/o7AvnRRjcH&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/999323515215020034?ref_src=twsrc%5Etfw&#34;&gt;May 23, 2018&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/lineEducationLoans.gif&#34; alt=&#34;Average cumulative student loan balance for graduate school completers, by degree type: Selected years, 2000-2016&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Average cumulative student loan balance for graduate school completers, by degree type: Selected years, 2000-2016&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Seasonal Virgin River Narrows Discharge</title>
      <link>/posts/2018-04-16-hiking-the-narrows/</link>
      <pubDate>Mon, 16 Apr 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/posts/2018-04-16-hiking-the-narrows/</guid>
      <description>&lt;p&gt;This April I’m visiting Zion National Park, one of North America’s most interesting locations to explore geologic formations. One such venue in the park is an iconic hike referred to as &lt;em&gt;The Narrows&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/narrows.jpg&#34; alt=&#34;The Narrows in Zion National Park&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;The Narrows in Zion National Park&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;It’s surely even more sensational in person.&lt;/p&gt;
&lt;p&gt;Unfortunately, there’s a catch: the Virgin River, a Colorado river tributary that shaped the distinct rock walls of The Narrows, has seasonal water level changes that can force hikers to trek waist deep in the river or close the route entirely. Online sources confirmed my intuition that the spring run-off leads to closures, but I was curious the extent of seasonality. Let’s dig into it!&lt;/p&gt;
&lt;div id=&#34;accessing-the-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Accessing the data&lt;/h2&gt;
&lt;p&gt;The provisional data for the East Fork of the Virgin River can be easily &lt;a href=&#34;https://waterdata.usgs.gov/ut/nwis/uv?cb_00065=on&amp;amp;cb_00060=on&amp;amp;format=gif_default&amp;amp;period=60&amp;amp;begin_date=&amp;amp;end_date=&amp;amp;site_no=09404900&#34;&gt;accessed via the USGS website&lt;/a&gt;, including discharge and gage height. I’ll focus on the discharge levels here, since the speed of the river (and not it’s height) is what seems to precipitate closures. The speed threshold that merits closure of The Narrows was inconsistent across the sites I investigated (if you know leave a comment), but the level I saw most often - 150 cfs - is what I will use.&lt;/p&gt;
&lt;p&gt;A brief aside: the USGS logs some super interesting data to visualize time series. Here are some continually updated &lt;a href=&#34;https://waterdata.usgs.gov/ut/nwis/uv?cb_00065=on&amp;amp;cb_00060=on&amp;amp;format=gif_default&amp;amp;period=60&#34;&gt;sources of water data for Utah&lt;/a&gt;, for example. So much to explore!&lt;/p&gt;
&lt;p&gt;Back to The Narrows data. So we’ve got out the csv and it was completely clean like always the end! Not.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;cleaning-the-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Cleaning the data&lt;/h2&gt;
&lt;p&gt;There was quite a few strange coding choices made through the years accessed (1993 - 2018). What follows are those gory recoding details. One nifty function I learned more about was &lt;code&gt;dplyr::separate&lt;/code&gt; which allows you to specify the direction you’d like to merge the characters you’re separating. This allowed me to push values of &lt;code&gt;0 seconds&lt;/code&gt; ino the seconds column, even though there were some values where there were no adjoining hours or minutes attached. Nifty!&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(animation)
library(grid)
x &amp;lt;- read.csv(&amp;quot;/home/michael/Documents/website/narrows/narrows.csv&amp;quot;, row.names = NULL, stringsAsFactors = FALSE)
x &amp;lt;- x[1:530086,]
x2 &amp;lt;- read.csv(&amp;quot;/home/michael/Documents/website/narrows/narrows2.csv&amp;quot;, row.names = NULL, stringsAsFactors = FALSE)
x &amp;lt;- rbind(x,x2)
rm(x2)
x &amp;lt;- x %&amp;gt;% separate(datetime, c(&amp;quot;date&amp;quot;, &amp;quot;time&amp;quot;), &amp;quot; &amp;quot;, extra = &amp;quot;merge&amp;quot;)
x$date &amp;lt;- mdy(x$date)
x$timeparse &amp;lt;- hm(x$time)
x &amp;lt;- x %&amp;gt;% separate(timeparse, c(&amp;quot;hour&amp;quot;, &amp;quot;minute&amp;quot;, &amp;quot;second&amp;quot;), &amp;quot; &amp;quot;, extra = &amp;quot;merge&amp;quot;, fill = &amp;quot;left&amp;quot;)
x$hour &amp;lt;- gsub(&amp;quot;H&amp;quot;, &amp;quot;&amp;quot;, x$hour)
x$minute &amp;lt;- gsub(&amp;quot;M&amp;quot;, &amp;quot;&amp;quot;, x$minute)
x$second &amp;lt;- gsub(&amp;quot;S&amp;quot;, &amp;quot;&amp;quot;, x$second)
x[,c(&amp;quot;hour&amp;quot;,&amp;quot;minute&amp;quot;,&amp;quot;second&amp;quot;)] &amp;lt;- sapply(x[,c(&amp;quot;hour&amp;quot;,&amp;quot;minute&amp;quot;,&amp;quot;second&amp;quot;)], as.numeric)
x$hour &amp;lt;- ifelse(is.na(x$hour),0 ,x$hour)
x$minute &amp;lt;- ifelse(is.na(x$minute),0 ,x$minute)
x$hour &amp;lt;- ifelse(grepl(&amp;quot;PM&amp;quot;, x$time), x$hour + 12,x$hour)
x$hour &amp;lt;- ifelse(nchar(x$hour) &amp;lt; 2, paste0(&amp;quot;0&amp;quot;,as.character(x$hour)),as.character(x$hour))
x$minute &amp;lt;- ifelse(nchar(x$minute) &amp;lt; 2, paste0(&amp;quot;0&amp;quot;,as.character(x$minute)),as.character(x$minute))
x$second &amp;lt;- ifelse(nchar(x$second) &amp;lt; 2, paste0(&amp;quot;0&amp;quot;,as.character(x$second)),as.character(x$second))
x$hour &amp;lt;- ifelse(grepl(&amp;quot;24&amp;quot;, x$hour), &amp;quot;00&amp;quot;,x$hour)
x$timeUpdate &amp;lt;- paste(x$hour,x$minute,x$second, sep = &amp;quot;:&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The full data source as an &lt;strong&gt;.Rdata&lt;/strong&gt; file can be accessed through &lt;a href=&#34;https://mikelee.co/data/narrows.Rdata&#34;&gt;this link&lt;/a&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;drill-down-and-visualize&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Drill down and visualize&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;dplyr&lt;/code&gt; and &lt;code&gt;lubridate&lt;/code&gt; package make it easy to extract seasonality in the data:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dischargeByDay &amp;lt;- x %&amp;gt;% mutate(day = yday(date)) %&amp;gt;%
  group_by(day) %&amp;gt;%
  summarise(avgDischarge = mean(discharge, na.rm = TRUE))

dischargeByDay$day &amp;lt;- as.Date(as_date(dischargeByDay$day))
dischargeByDay$month &amp;lt;- month(dischargeByDay$day, label = TRUE)

plot(dischargeByDay$day, dischargeByDay$avgDischarge)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2018-04-16-hiking-the-narrows_files/figure-html/drill%20down-1.png&#34; width=&#34;1260&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This result is convincing on it’s own: on average from 1993 to 2018, after about 100 days and lasting until about the 160th day (Apri 10th - June 10th), the discharge level breaks the 150 cfs threshold that closes The Narrows hiking route.&lt;/p&gt;
&lt;p&gt;Lets take this result and make it more visually engaging by adding some animation.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;start-with-our-skeleton-plot&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Start with our skeleton plot&lt;/h2&gt;
&lt;p&gt;I’ve been poking around with image dimensions and themes for distribution through twitter, and the following theme seems to be a quality balance between plot elements:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;theme_white &amp;lt;- theme(text = element_text(family=&amp;quot;Open Sans&amp;quot;, color = &amp;quot;black&amp;quot;),
                     panel.grid = element_blank(),
                     panel.border = element_blank(),
                     axis.title.x=element_text(size=26, family = &amp;quot;Open Sans&amp;quot;, margin = margin(t=15, b = 0)),
                     axis.title.y=element_text(size=26, family = &amp;quot;Open Sans&amp;quot;, margin = margin(r=15, l = 5)),
                     axis.text.x=element_text(size=22, hjust = 0, family = &amp;quot;Open Sans Light&amp;quot;),
                     axis.text.y=element_text(size=22, family = &amp;quot;Open Sans Light&amp;quot;),
                     axis.ticks = element_blank(),           
                     plot.title=element_text(size=34,family = &amp;quot;Open Sans Extrabold&amp;quot;,hjust= 0,lineheight=1, margin = margin(t = 15)),
                     plot.subtitle=element_text(size=26, margin = margin(t=15, b = 5),family = &amp;quot;Open Sans&amp;quot;),
                     plot.caption=element_text(size=18, hjust = 0,margin=margin(t=15, b = 15),lineheight=1.15, family = &amp;quot;Open Sans&amp;quot;),
                     legend.position=&amp;quot;none&amp;quot;
)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It’s important to impelement limits and breaks in the y and x scales to keep the axes stable when using ggplot2 for animation. Otherwise, the plot axes will expand according to the subset of data used in the figure.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;gg &amp;lt;- ggplot(dischargeByDay, aes(x = day, y = avgDischarge, group = 1)) +
  scale_y_continuous(limits = c(0, 350), expand = c(0,0)) +
  scale_x_date(date_breaks = &amp;quot;1 month&amp;quot;, date_labels =  &amp;quot;%b&amp;quot;, expand = c(0,0),limits = c(min(dischargeByDay$day)-1,max(dischargeByDay$day)-2)) +
  labs(title = &amp;quot;Mean Flow of the VIRGIN RIVER NARROWS by day (1993 - 2018)&amp;quot;,
       subtitle = &amp;quot;If the river is flowing at over 150 Cubic Feet per Second (CFS) the narrows is closed&amp;quot;,
       caption = &amp;quot;Data Accessed 3/16/2018, retrieved via https://nwis.waterdata.usgs.gov/usa/nwis/uv/&amp;quot;) +
  xlab(&amp;quot;Date&amp;quot;) + ylab(&amp;quot;Average Discharge&amp;quot;) +
  theme_bw() + theme_white
gg&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/gg.png&#34; alt=&#34;Mean Flow of the VIRGIN RIVER NARROWS by day (1993 - 2018)&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Mean Flow of the VIRGIN RIVER NARROWS by day (1993 - 2018)&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We’ll then use &lt;code&gt;tweenr&lt;/code&gt; and &lt;code&gt;animation&lt;/code&gt; to refine the visualization with smooth transitions.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;animate-all-the-things&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animate all the things!&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;gifReplicate &amp;lt;- function(x) {
  grid.newpage()
  grid.draw(x)
}

yDates &amp;lt;- seq(from = 0, to = max(as.numeric(dischargeByDay$day)), by = 3)
yDates[1] &amp;lt;- 1

saveGIF({

  for (i in yDates) {
    
    gg2 &amp;lt;- gg + geom_point(data = subset(dischargeByDay, day &amp;lt;=i), aes(x = day, y = avgDischarge), alpha = .1)
    g &amp;lt;- ggplotGrob(gg2)
    g$layout$l[g$layout$name == &amp;quot;title&amp;quot;] &amp;lt;- 3
    g$layout$l[g$layout$name == &amp;quot;caption&amp;quot;] &amp;lt;- 3
    g$layout$l[g$layout$name == &amp;quot;subtitle&amp;quot;] &amp;lt;- 3
    grid::grid.draw(g); 
    grid.newpage()
  }
  
  grid::grid.draw(g); 
  replicate(10,gifReplicate(g))

  for (i in seq(from =1, to = 366, by = 7)) {
    
    gg3 &amp;lt;- gg2 + geom_segment(x = 1, xend = i, y = 150,yend = 150, color= &amp;quot;red&amp;quot;, linetype = 2) 
    g &amp;lt;- ggplotGrob(gg3)
    g$layout$l[g$layout$name == &amp;quot;title&amp;quot;] &amp;lt;- 3
    g$layout$l[g$layout$name == &amp;quot;caption&amp;quot;] &amp;lt;- 3
    g$layout$l[g$layout$name == &amp;quot;subtitle&amp;quot;] &amp;lt;- 3
    grid::grid.draw(g); 
    grid.newpage()
  }
  
  for (i in yDates) {
    
    gg4 &amp;lt;- gg3 + stat_smooth(data = subset(dischargeByDay, day &amp;lt;=i), aes(x = day), se = F, method = &amp;quot;lm&amp;quot;, formula = y ~ poly(x, 20))
    g &amp;lt;- ggplotGrob(gg4)
    g$layout$l[g$layout$name == &amp;quot;title&amp;quot;] &amp;lt;- 3
    g$layout$l[g$layout$name == &amp;quot;caption&amp;quot;] &amp;lt;- 3
    g$layout$l[g$layout$name == &amp;quot;subtitle&amp;quot;] &amp;lt;- 3
    grid::grid.draw(g); 
    grid.newpage()
  }
  
  grid::grid.draw(g); 
  replicate(100,gifReplicate(g))
  # grid.draw(gg4)
  # geom_hline(yintercept = 150, color= &amp;quot;red&amp;quot;, linetype = 2) + 
  #   geom_line(aes(x=day, y=avgDischarge), size=1.3) +
},movie.name=paste0(getwd(),&amp;quot;/narrowsLarge.gif&amp;quot;),interval = .02, ani.width = 1200, ani.height = 800)

gif_compress &amp;lt;- function(ingif, outgif, show=TRUE, extra.opts=&amp;quot;&amp;quot;){
  command &amp;lt;-  sprintf(&amp;quot;gifsicle -O3 %s &amp;lt; %s &amp;gt; %s&amp;quot;, extra.opts, ingif, outgif)
  system.fun &amp;lt;- if (.Platform$OS.type == &amp;quot;windows&amp;quot;) shell else system
  if(show) message(&amp;quot;Executing: &amp;quot;, strwrap(command, exdent = 2, prefix = &amp;quot;\n&amp;quot;))
  system.fun(ifelse(.Platform$OS.type == &amp;quot;windows&amp;quot;, sprintf(&amp;quot;\&amp;quot;%s\&amp;quot;&amp;quot;, shQuote(command)), command))
}

gif_compress(paste0(getwd(),&amp;quot;/narrowsLarge.gif&amp;quot;),
             paste0(getwd(),&amp;quot;/narrowsLargeTall.gif&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/narrowsLargeTall.gif&#34; alt=&#34;Mean Flow of the VIRGIN RIVER NARROWS by day (1993 - 2018)&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Mean Flow of the VIRGIN RIVER NARROWS by day (1993 - 2018)&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;addendum---further-data-exploration-needed&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Addendum - Further Data Exploration Needed:&lt;/h3&gt;
&lt;p&gt;After generating this animation and before sitting down to write this post, I explored the data a little bit more. To my delight (or chagrin) there appears to be a daily pattern to the discharge level. Looking at just April results, the discharge level decreases from 2pm to 5pm before reversing course and increasing until about 2am.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dischargeByAprilHour &amp;lt;- x %&amp;gt;% filter(month(date) == 4) %&amp;gt;%
  mutate(day = yday(date)) %&amp;gt;%
  group_by(hour) %&amp;gt;%
  summarise(avgDischarge = mean(discharge, na.rm = TRUE))
plot(dischargeByAprilHour$hour, dischargeByAprilHour$avgDischarge)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2018-04-16-hiking-the-narrows_files/figure-html/daily%20changes%20in%20April-1.png&#34; width=&#34;1260&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;An exploration for another day or another analyst!&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Percentage of revenue for elementary and secondary public schools</title>
      <link>/animation/2018-02-12-animated-line-school-revenue/</link>
      <pubDate>Mon, 12 Feb 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2018-02-12-animated-line-school-revenue/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
NEW Finding: Federal sources accounted for approx. 9% of the total funding for &lt;a href=&#34;https://twitter.com/hashtag/K12?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#K12&lt;/a&gt; public schools in both 2005–06 and 2014 –15. &lt;a href=&#34;https://t.co/G16loc8pyW&#34;&gt;https://t.co/G16loc8pyW&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Education?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#Education&lt;/a&gt; &lt;a href=&#34;https://t.co/CFuRjcqMIS&#34;&gt;pic.twitter.com/CFuRjcqMIS&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/963158870557421568?ref_src=twsrc%5Etfw&#34;&gt;February 12, 2018&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/lineSchool_Revenue.gif&#34; alt=&#34;Percentage of revenue for elementary and secondary public schools&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Percentage of revenue for elementary and secondary public schools&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Highest and lowest spending states per public education pupil</title>
      <link>/animation/2018-01-29-animated-line-chart-expenditures/</link>
      <pubDate>Mon, 29 Jan 2018 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2018-01-29-animated-line-chart-expenditures/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
DYK? Current expenditures per pupil ranged from $6,751 in Utah to $20,744 in New York for FY 2015: &lt;a href=&#34;https://t.co/FDcsYpjmcj&#34;&gt;https://t.co/FDcsYpjmcj&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Finance?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#Finance&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Education?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#Education&lt;/a&gt; &lt;a href=&#34;https://t.co/r5kUgNE4vF&#34;&gt;pic.twitter.com/r5kUgNE4vF&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/956970572189241344?ref_src=twsrc%5Etfw&#34;&gt;January 26, 2018&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/barState_Expenditure.gif&#34; alt=&#34;Current Expenditures per pupil in the lowest and highest spending states&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Current Expenditures per pupil in the lowest and highest spending states&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Wisconsin State Hex Grid - Mapping 2016 Presidential Results</title>
      <link>/posts/2017-11-16-wi-presidential-results-using-hexmapr/</link>
      <pubDate>Thu, 16 Nov 2017 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/posts/2017-11-16-wi-presidential-results-using-hexmapr/</guid>
      <description>&lt;div id=&#34;neat-package-alert&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;NEAT PACKAGE ALERT!&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
My 1st R package! &lt;a href=&#34;https://t.co/dI3GJbC7FQ&#34;&gt;https://t.co/dI3GJbC7FQ&lt;/a&gt; Automatically turn geospatial polygons like states into regular/hexagonal grids &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#ggplot2&lt;/a&gt; &lt;a href=&#34;https://t.co/dxvYCZWJzU&#34;&gt;pic.twitter.com/dxvYCZWJzU&lt;/a&gt;
&lt;/p&gt;
— J Bailey (&lt;span class=&#34;citation&#34;&gt;@iammrbailey&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/iammrbailey/status/925346870381240320?ref_src=twsrc%5Etfw&#34;&gt;October 31, 2017&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;p&gt;I’ve been thinking about implementing something like this for a while - got excited by this tweet I thought I would do some exploring and write out a post over the weekend. Creating a county-level hex grid of Wisconsin makes for a perfect supplment to my earlier post about &lt;a href=&#34;https://www.mikelee.co/posts/2016-12-26-wisconsin-presidential-election-results/&#34;&gt;mapping the 2016 Wisconsin presidential results&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;lets-make-a-hex-grid-of-wisconsin&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Let’s make a hex grid of Wisconsin&lt;/h2&gt;
&lt;p&gt;The first thing we’ll do is retrieve a Wisconsin shapefile; we can use the &lt;code&gt;tigris&lt;/code&gt; package developed by Kyle Walker to pull a 2010 census shapefile of Wisconsin counties:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tigris)
wi &amp;lt;- counties(&amp;quot;Wisconsin&amp;quot;, cb = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
  |                                                                                                                                        
  |                                                                                                                                  |   0%
  |                                                                                                                                        
  |=                                                                                                                                 |   0%
  |                                                                                                                                        
  |=                                                                                                                                 |   1%
  |                                                                                                                                        
  |==                                                                                                                                |   1%
  |                                                                                                                                        
  |==                                                                                                                                |   2%
  |                                                                                                                                        
  |===                                                                                                                               |   2%
  |                                                                                                                                        
  |===                                                                                                                               |   3%
  |                                                                                                                                        
  |====                                                                                                                              |   3%
  |                                                                                                                                        
  |=====                                                                                                                             |   4%
  |                                                                                                                                        
  |======                                                                                                                            |   4%
  |                                                                                                                                        
  |======                                                                                                                            |   5%
  |                                                                                                                                        
  |=======                                                                                                                           |   5%
  |                                                                                                                                        
  |=======                                                                                                                           |   6%
  |                                                                                                                                        
  |========                                                                                                                          |   6%
  |                                                                                                                                        
  |========                                                                                                                          |   7%
  |                                                                                                                                        
  |=========                                                                                                                         |   7%
  |                                                                                                                                        
  |==========                                                                                                                        |   7%
  |                                                                                                                                        
  |==========                                                                                                                        |   8%
  |                                                                                                                                        
  |===========                                                                                                                       |   8%
  |                                                                                                                                        
  |===========                                                                                                                       |   9%
  |                                                                                                                                        
  |============                                                                                                                      |   9%
  |                                                                                                                                        
  |============                                                                                                                      |  10%
  |                                                                                                                                        
  |=============                                                                                                                     |  10%
  |                                                                                                                                        
  |==============                                                                                                                    |  10%
  |                                                                                                                                        
  |==============                                                                                                                    |  11%
  |                                                                                                                                        
  |===============                                                                                                                   |  11%
  |                                                                                                                                        
  |===============                                                                                                                   |  12%
  |                                                                                                                                        
  |================                                                                                                                  |  12%
  |                                                                                                                                        
  |================                                                                                                                  |  13%
  |                                                                                                                                        
  |=================                                                                                                                 |  13%
  |                                                                                                                                        
  |==================                                                                                                                |  13%
  |                                                                                                                                        
  |==================                                                                                                                |  14%
  |                                                                                                                                        
  |===================                                                                                                               |  14%
  |                                                                                                                                        
  |===================                                                                                                               |  15%
  |                                                                                                                                        
  |====================                                                                                                              |  15%
  |                                                                                                                                        
  |====================                                                                                                              |  16%
  |                                                                                                                                        
  |=====================                                                                                                             |  16%
  |                                                                                                                                        
  |======================                                                                                                            |  17%
  |                                                                                                                                        
  |=======================                                                                                                           |  17%
  |                                                                                                                                        
  |=======================                                                                                                           |  18%
  |                                                                                                                                        
  |========================                                                                                                          |  18%
  |                                                                                                                                        
  |========================                                                                                                          |  19%
  |                                                                                                                                        
  |=========================                                                                                                         |  19%
  |                                                                                                                                        
  |=========================                                                                                                         |  20%
  |                                                                                                                                        
  |==========================                                                                                                        |  20%
  |                                                                                                                                        
  |===========================                                                                                                       |  20%
  |                                                                                                                                        
  |===========================                                                                                                       |  21%
  |                                                                                                                                        
  |============================                                                                                                      |  21%
  |                                                                                                                                        
  |============================                                                                                                      |  22%
  |                                                                                                                                        
  |=============================                                                                                                     |  22%
  |                                                                                                                                        
  |=============================                                                                                                     |  23%
  |                                                                                                                                        
  |==============================                                                                                                    |  23%
  |                                                                                                                                        
  |===============================                                                                                                   |  24%
  |                                                                                                                                        
  |================================                                                                                                  |  24%
  |                                                                                                                                        
  |================================                                                                                                  |  25%
  |                                                                                                                                        
  |=================================                                                                                                 |  25%
  |                                                                                                                                        
  |=================================                                                                                                 |  26%
  |                                                                                                                                        
  |==================================                                                                                                |  26%
  |                                                                                                                                        
  |===================================                                                                                               |  27%
  |                                                                                                                                        
  |====================================                                                                                              |  27%
  |                                                                                                                                        
  |====================================                                                                                              |  28%
  |                                                                                                                                        
  |=====================================                                                                                             |  28%
  |                                                                                                                                        
  |=====================================                                                                                             |  29%
  |                                                                                                                                        
  |======================================                                                                                            |  29%
  |                                                                                                                                        
  |======================================                                                                                            |  30%
  |                                                                                                                                        
  |=======================================                                                                                           |  30%
  |                                                                                                                                        
  |========================================                                                                                          |  30%
  |                                                                                                                                        
  |========================================                                                                                          |  31%
  |                                                                                                                                        
  |=========================================                                                                                         |  31%
  |                                                                                                                                        
  |=========================================                                                                                         |  32%
  |                                                                                                                                        
  |==========================================                                                                                        |  32%
  |                                                                                                                                        
  |==========================================                                                                                        |  33%
  |                                                                                                                                        
  |===========================================                                                                                       |  33%
  |                                                                                                                                        
  |============================================                                                                                      |  34%
  |                                                                                                                                        
  |=============================================                                                                                     |  34%
  |                                                                                                                                        
  |=============================================                                                                                     |  35%
  |                                                                                                                                        
  |==============================================                                                                                    |  35%
  |                                                                                                                                        
  |==============================================                                                                                    |  36%
  |                                                                                                                                        
  |===============================================                                                                                   |  36%
  |                                                                                                                                        
  |===============================================                                                                                   |  37%
  |                                                                                                                                        
  |================================================                                                                                  |  37%
  |                                                                                                                                        
  |=================================================                                                                                 |  37%
  |                                                                                                                                        
  |=================================================                                                                                 |  38%
  |                                                                                                                                        
  |==================================================                                                                                |  38%
  |                                                                                                                                        
  |==================================================                                                                                |  39%
  |                                                                                                                                        
  |===================================================                                                                               |  39%
  |                                                                                                                                        
  |===================================================                                                                               |  40%
  |                                                                                                                                        
  |====================================================                                                                              |  40%
  |                                                                                                                                        
  |=====================================================                                                                             |  41%
  |                                                                                                                                        
  |======================================================                                                                            |  41%
  |                                                                                                                                        
  |======================================================                                                                            |  42%
  |                                                                                                                                        
  |=======================================================                                                                           |  42%
  |                                                                                                                                        
  |=======================================================                                                                           |  43%
  |                                                                                                                                        
  |========================================================                                                                          |  43%
  |                                                                                                                                        
  |=========================================================                                                                         |  43%
  |                                                                                                                                        
  |=========================================================                                                                         |  44%
  |                                                                                                                                        
  |==========================================================                                                                        |  44%
  |                                                                                                                                        
  |==========================================================                                                                        |  45%
  |                                                                                                                                        
  |===========================================================                                                                       |  45%
  |                                                                                                                                        
  |===========================================================                                                                       |  46%
  |                                                                                                                                        
  |============================================================                                                                      |  46%
  |                                                                                                                                        
  |=============================================================                                                                     |  47%
  |                                                                                                                                        
  |==============================================================                                                                    |  47%
  |                                                                                                                                        
  |==============================================================                                                                    |  48%
  |                                                                                                                                        
  |===============================================================                                                                   |  48%
  |                                                                                                                                        
  |===============================================================                                                                   |  49%
  |                                                                                                                                        
  |================================================================                                                                  |  49%
  |                                                                                                                                        
  |================================================================                                                                  |  50%
  |                                                                                                                                        
  |=================================================================                                                                 |  50%
  |                                                                                                                                        
  |==================================================================                                                                |  50%
  |                                                                                                                                        
  |==================================================================                                                                |  51%
  |                                                                                                                                        
  |===================================================================                                                               |  51%
  |                                                                                                                                        
  |===================================================================                                                               |  52%
  |                                                                                                                                        
  |====================================================================                                                              |  52%
  |                                                                                                                                        
  |====================================================================                                                              |  53%
  |                                                                                                                                        
  |=====================================================================                                                             |  53%
  |                                                                                                                                        
  |======================================================================                                                            |  54%
  |                                                                                                                                        
  |=======================================================================                                                           |  54%
  |                                                                                                                                        
  |=======================================================================                                                           |  55%
  |                                                                                                                                        
  |========================================================================                                                          |  55%
  |                                                                                                                                        
  |========================================================================                                                          |  56%
  |                                                                                                                                        
  |=========================================================================                                                         |  56%
  |                                                                                                                                        
  |=========================================================================                                                         |  57%
  |                                                                                                                                        
  |==========================================================================                                                        |  57%
  |                                                                                                                                        
  |===========================================================================                                                       |  57%
  |                                                                                                                                        
  |===========================================================================                                                       |  58%
  |                                                                                                                                        
  |============================================================================                                                      |  58%
  |                                                                                                                                        
  |============================================================================                                                      |  59%
  |                                                                                                                                        
  |=============================================================================                                                     |  59%
  |                                                                                                                                        
  |=============================================================================                                                     |  60%
  |                                                                                                                                        
  |==============================================================================                                                    |  60%
  |                                                                                                                                        
  |===============================================================================                                                   |  60%
  |                                                                                                                                        
  |===============================================================================                                                   |  61%
  |                                                                                                                                        
  |================================================================================                                                  |  61%
  |                                                                                                                                        
  |================================================================================                                                  |  62%
  |                                                                                                                                        
  |=================================================================================                                                 |  62%
  |                                                                                                                                        
  |=================================================================================                                                 |  63%
  |                                                                                                                                        
  |==================================================================================                                                |  63%
  |                                                                                                                                        
  |===================================================================================                                               |  63%
  |                                                                                                                                        
  |===================================================================================                                               |  64%
  |                                                                                                                                        
  |====================================================================================                                              |  64%
  |                                                                                                                                        
  |====================================================================================                                              |  65%
  |                                                                                                                                        
  |=====================================================================================                                             |  65%
  |                                                                                                                                        
  |=====================================================================================                                             |  66%
  |                                                                                                                                        
  |======================================================================================                                            |  66%
  |                                                                                                                                        
  |=======================================================================================                                           |  67%
  |                                                                                                                                        
  |========================================================================================                                          |  67%
  |                                                                                                                                        
  |========================================================================================                                          |  68%
  |                                                                                                                                        
  |=========================================================================================                                         |  68%
  |                                                                                                                                        
  |=========================================================================================                                         |  69%
  |                                                                                                                                        
  |==========================================================================================                                        |  69%
  |                                                                                                                                        
  |==========================================================================================                                        |  70%
  |                                                                                                                                        
  |===========================================================================================                                       |  70%
  |                                                                                                                                        
  |============================================================================================                                      |  70%
  |                                                                                                                                        
  |============================================================================================                                      |  71%
  |                                                                                                                                        
  |=============================================================================================                                     |  71%
  |                                                                                                                                        
  |=============================================================================================                                     |  72%
  |                                                                                                                                        
  |==============================================================================================                                    |  72%
  |                                                                                                                                        
  |==============================================================================================                                    |  73%
  |                                                                                                                                        
  |===============================================================================================                                   |  73%
  |                                                                                                                                        
  |================================================================================================                                  |  74%
  |                                                                                                                                        
  |=================================================================================================                                 |  74%
  |                                                                                                                                        
  |=================================================================================================                                 |  75%
  |                                                                                                                                        
  |==================================================================================================                                |  75%
  |                                                                                                                                        
  |==================================================================================================                                |  76%
  |                                                                                                                                        
  |===================================================================================================                               |  76%
  |                                                                                                                                        
  |====================================================================================================                              |  77%
  |                                                                                                                                        
  |=====================================================================================================                             |  77%
  |                                                                                                                                        
  |=====================================================================================================                             |  78%
  |                                                                                                                                        
  |======================================================================================================                            |  78%
  |                                                                                                                                        
  |======================================================================================================                            |  79%
  |                                                                                                                                        
  |=======================================================================================================                           |  79%
  |                                                                                                                                        
  |=======================================================================================================                           |  80%
  |                                                                                                                                        
  |========================================================================================================                          |  80%
  |                                                                                                                                        
  |=========================================================================================================                         |  80%
  |                                                                                                                                        
  |=========================================================================================================                         |  81%
  |                                                                                                                                        
  |==========================================================================================================                        |  81%
  |                                                                                                                                        
  |==========================================================================================================                        |  82%
  |                                                                                                                                        
  |===========================================================================================================                       |  82%
  |                                                                                                                                        
  |===========================================================================================================                       |  83%
  |                                                                                                                                        
  |============================================================================================================                      |  83%
  |                                                                                                                                        
  |=============================================================================================================                     |  84%
  |                                                                                                                                        
  |==============================================================================================================                    |  84%
  |                                                                                                                                        
  |==============================================================================================================                    |  85%
  |                                                                                                                                        
  |===============================================================================================================                   |  85%
  |                                                                                                                                        
  |===============================================================================================================                   |  86%
  |                                                                                                                                        
  |================================================================================================================                  |  86%
  |                                                                                                                                        
  |================================================================================================================                  |  87%
  |                                                                                                                                        
  |=================================================================================================================                 |  87%
  |                                                                                                                                        
  |==================================================================================================================                |  87%
  |                                                                                                                                        
  |==================================================================================================================                |  88%
  |                                                                                                                                        
  |===================================================================================================================               |  88%
  |                                                                                                                                        
  |===================================================================================================================               |  89%
  |                                                                                                                                        
  |====================================================================================================================              |  89%
  |                                                                                                                                        
  |====================================================================================================================              |  90%
  |                                                                                                                                        
  |=====================================================================================================================             |  90%
  |                                                                                                                                        
  |======================================================================================================================            |  91%
  |                                                                                                                                        
  |=======================================================================================================================           |  91%
  |                                                                                                                                        
  |=======================================================================================================================           |  92%
  |                                                                                                                                        
  |========================================================================================================================          |  92%
  |                                                                                                                                        
  |========================================================================================================================          |  93%
  |                                                                                                                                        
  |=========================================================================================================================         |  93%
  |                                                                                                                                        
  |==========================================================================================================================        |  93%
  |                                                                                                                                        
  |==========================================================================================================================        |  94%
  |                                                                                                                                        
  |===========================================================================================================================       |  94%
  |                                                                                                                                        
  |===========================================================================================================================       |  95%
  |                                                                                                                                        
  |============================================================================================================================      |  95%
  |                                                                                                                                        
  |============================================================================================================================      |  96%
  |                                                                                                                                        
  |=============================================================================================================================     |  96%
  |                                                                                                                                        
  |==============================================================================================================================    |  97%
  |                                                                                                                                        
  |===============================================================================================================================   |  97%
  |                                                                                                                                        
  |===============================================================================================================================   |  98%
  |                                                                                                                                        
  |================================================================================================================================  |  98%
  |                                                                                                                                        
  |================================================================================================================================  |  99%
  |                                                                                                                                        
  |================================================================================================================================= |  99%
  |                                                                                                                                        
  |================================================================================================================================= | 100%
  |                                                                                                                                        
  |==================================================================================================================================| 100%&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wi_original &amp;lt;- wi
plot(wi)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/tigris%20shapefile-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We’ll then port some code from the &lt;code&gt;hexmapr&lt;/code&gt; github README:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(hexmapr)
wi_details &amp;lt;- get_shape_details(wi)
wi@data$xcentroid &amp;lt;- coordinates(wi)[,1]
wi@data$ycentroid &amp;lt;- coordinates(wi)[,2]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’re going for the closest shapefile match, preferring a final shape than looks like the outline of the state than one with appropriate placement of counties - there is rarely a perfect grid match. So let’s test a whole bunch:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# hexagon - red border for the 28th seed
png(file = &amp;quot;/home/michael/Documents/mikeleeco.github.com/static/img/hexGridWisconsin.png&amp;quot;, width = 700, height = 500)
par(mfrow=c(7,5), mar = c(0,1,2,1))
for (i in 1:35){
  new_cells &amp;lt;-  calculate_cell_size(wi, wi_details,0.03, &amp;#39;hexagonal&amp;#39;, i)
  if(i == 28) {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;), border = &amp;quot;red&amp;quot;)
  } else {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;))
  }
}

# squares - red border for the 7th seed
png(file = &amp;quot;/home/michael/Documents/mikeleeco.github.com/static/img/squareGridWisconsin.png&amp;quot;, width = 700, height = 500)
par(mfrow=c(7,5), mar = c(0,1,2,1))
for (i in 1:35){
  new_cells &amp;lt;-  calculate_cell_size(wi, wi_details,0.03, &amp;#39;regular&amp;#39;, i)
  if(i == 7) {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;), border = &amp;quot;red&amp;quot;)
  } else {
    plot(new_cells[[2]], main = paste(&amp;quot;Seed&amp;quot;,i, sep=&amp;quot; &amp;quot;))
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/hexGridWisconsin.png&#34; alt=&#34;hex grid options&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;hex grid options&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/squareGridWisconsin.png&#34; alt=&#34;square grid options&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;square grid options&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;I like the look of the 28th hexagon grid, and the 7th square grid. Let’s take those and assign the polygons to a new &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;, then fortify .&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(ggplot2)
clean &amp;lt;- function(shape){
  shape@data$id = rownames(shape@data)
  shape.points = fortify(shape, region=&amp;quot;id&amp;quot;)
  shape.df = left_join(shape.points, shape@data, by=&amp;quot;id&amp;quot;)
}

new_cells_hex &amp;lt;-  calculate_cell_size(wi_original, wi_details,0.03, &amp;#39;hexagonal&amp;#39;, 28)
resulthex &amp;lt;- assign_polygons(wi_original,new_cells_hex)
result_df_hex &amp;lt;- clean(resulthex)

new_cells_square &amp;lt;-  calculate_cell_size(wi_original, wi_details,0.03, &amp;#39;regular&amp;#39;, 7)
resultsquare &amp;lt;- assign_polygons(wi_original,new_cells_square)
result_df_square &amp;lt;- clean(resultsquare)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now that we’ve got our modified &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;s - covered to a dataframe for use with ggplot2 - we can plot the result using &lt;code&gt;geom_polygon&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(viridis)
library(extrafont)
loadfonts()
theme_open_sans &amp;lt;- theme(text=element_text(family=&amp;quot;Open Sans&amp;quot;), plot.title = element_text(family = &amp;quot;Open Sans Semibold&amp;quot;, size = 24), plot.subtitle = element_text(family = &amp;quot;Open Sans Light&amp;quot;,size = 14), legend.title = element_text(family=&amp;quot;Open Sans Semibold&amp;quot;))
hexplot &amp;lt;- ggplot(result_df_hex) +
  geom_polygon(aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
  geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;white&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
  scale_fill_viridis() +
  guides(fill=FALSE) +
  theme_void() + theme_open_sans

hexplot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/square%20and%20hex%20plots%20of%20WI-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;squareplot &amp;lt;- ggplot(result_df_square) +
  geom_polygon(aes(x=long, y=lat, fill = as.numeric(ALAND), group = group))+
  geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;white&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
  scale_fill_viridis() +
  guides(fill=FALSE) +
  theme_void() + theme_open_sans

squareplot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/square%20and%20hex%20plots%20of%20WI-2.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;I saw on twitter that &lt;code&gt;sf&lt;/code&gt; can now be used natively, so I gave that I try as well. First convert the &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt; to a simple feature (&lt;code&gt;sf&lt;/code&gt;), then plot the resultant object using &lt;code&gt;geom_sf&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sfResultSquare &amp;lt;- st_as_sf(resultsquare)
sfResultHex &amp;lt;- st_as_sf(resulthex)
class(sfResultHex)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;sf&amp;quot;         &amp;quot;data.frame&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sfHexPlot &amp;lt;-ggplot(sfResultHex) +
    geom_sf(aes(fill = as.numeric(ALAND)), color = &amp;quot;transparent&amp;quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;white&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
    scale_fill_viridis() +
    guides(fill=FALSE) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank())

sfHexPlot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/hexgrid%20with%20sf-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Cool to know that’s possible! Let’s use some more novel data than land area. Building off of a previous post mapping Wisconsin presidential election results, let’s map vote totals to our new gridmaps.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(stringr)
library(tidyr)
all_results &amp;lt;- read.csv(&amp;quot;https://raw.githubusercontent.com/mkearney/presidential_election_county_results_2016/master/pres16results.csv&amp;quot;, stringsAsFactors = FALSE)

wisconsin &amp;lt;- all_results %&amp;gt;% 
  filter(str_detect(fips, &amp;quot;^55&amp;quot;))

wisconsin_spread &amp;lt;- wisconsin %&amp;gt;% 
  filter(cand %in% c(&amp;quot;Donald Trump&amp;quot;, &amp;quot;Hillary Clinton&amp;quot;)) %&amp;gt;%
  select(fips, cand, votes, total_votes) %&amp;gt;%
  spread(cand, votes)

wisconsin_spread &amp;lt;- wisconsin_spread %&amp;gt;% mutate(voteDiff = `Donald Trump` - `Hillary Clinton`,
                                                pctDiff = `Donald Trump`/total_votes - `Hillary Clinton`/total_votes,
                                                weight = total_votes/ sum(total_votes))
wisconsin_spread$weight &amp;lt;- ifelse(wisconsin_spread$pctDiff &amp;gt; 0 , -wisconsin_spread$weight, wisconsin_spread$weight)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can create some custom breaks to give counties with higher vote totals more prominence in the figure, then merge these onto our hex and square &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wisconsin_spread$breaks &amp;lt;- cut(wisconsin_spread$weight,
                               breaks = c(-1, -.1, -0.05, -0.01, 0, 0.01, .05, .1, 1),
                               labels = c(&amp;quot;R   More than 10 Percent&amp;quot;, &amp;quot;R   5 to 10 Percent&amp;quot;, &amp;quot;R   1 to 5 Percent&amp;quot;, &amp;quot;R   Less than 1 Percent&amp;quot;, 
                                          &amp;quot;D   Less than 1 Percent&amp;quot;,&amp;quot;D   1 to 5 Percent&amp;quot;, &amp;quot;D   5 to 10 Percent&amp;quot;, &amp;quot;D   More than 10 Percent&amp;quot;))
wiHex &amp;lt;- merge(result_df_hex, wisconsin_spread, by.x = &amp;quot;GEOID&amp;quot;, by.y = &amp;quot;fips&amp;quot;)
wiSquare &amp;lt;- merge(result_df_square, wisconsin_spread, by.x = &amp;quot;GEOID&amp;quot;, by.y = &amp;quot;fips&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Once we’ve got our data sets finalized, figures are created usng &lt;code&gt;geom_polygon&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(RColorBrewer)

wiHexPlot &amp;lt;- ggplot(wiHex) +
    geom_polygon(aes(x=long, y=lat, fill=breaks, group = group), color = &amp;quot;#f5f5f5&amp;quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;black&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
    scale_fill_manual(name = &amp;quot;Portion of WI Vote&amp;quot;, values = brewer.pal(8, &amp;quot;RdBu&amp;quot;), drop = FALSE) +
    guides(alpha=FALSE) +
    ggtitle(label = &amp;quot;2016 Presidential Results by Wisconsin Counties&amp;quot;, subtitle = &amp;quot;59 of 72 Wisconsin counties leaned Republican, while the only two counties with\nmore than 10 percent of the state&amp;#39;s votes totaled more Democratic votes&amp;quot;) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +   
    theme_open_sans

wiHexPlot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/join%20election%20results%20to%20sf%20object-1.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;wiSquarePlot &amp;lt;- ggplot(wiSquare) +
    geom_polygon(aes(x=long, y=lat, fill=breaks, group = group), color = &amp;quot;#f5f5f5&amp;quot;) +
    geom_text(aes(V1, V2, label = NAME), size=2.5, color = &amp;quot;black&amp;quot;, family = &amp;quot;Open Sans&amp;quot;) +
    scale_fill_manual(name = &amp;quot;Percentage of WI Vote Total&amp;quot;, values = brewer.pal(8, &amp;quot;RdBu&amp;quot;), drop = FALSE) +
    guides(alpha=FALSE) +
    ggtitle(label = &amp;quot;2016 Presidential Results by Wisconsin Counties&amp;quot;, subtitle = &amp;quot;59 of 72 Wisconsin counties leaned Republican, while the only two counties with\nmore than 10 percent of the state&amp;#39;s votes totaled more Democratic votes&amp;quot;) +
    theme(panel.background = element_rect(fill = NA), axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +   
    theme_open_sans

wiSquarePlot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/posts/2017-11-16-wi-presidential-results-using-hexmapr_files/figure-html/join%20election%20results%20to%20sf%20object-2.png&#34; width=&#34;1800&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>High School Attainment - Line Chart from COE 2017 Data Release</title>
      <link>/animation/2017-10-19-high-school-attainment-rates/</link>
      <pubDate>Thu, 19 Oct 2017 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2017-10-19-high-school-attainment-rates/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
DYK? Gaps in HS completion rates between White students and Black and Hispanic students have narrowed. Learn more: &lt;a href=&#34;https://t.co/N6geIyokVp&#34;&gt;https://t.co/N6geIyokVp&lt;/a&gt; &lt;a href=&#34;https://t.co/tZtA6jVI30&#34;&gt;pic.twitter.com/tZtA6jVI30&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/921050270049718273?ref_src=twsrc%5Etfw&#34;&gt;October 19, 2017&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/line_High_School.gif&#34; alt=&#34;COE 2017 High School Attainment Line Graph Animation&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;COE 2017 High School Attainment Line Graph Animation&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Percent of Borrowers by Cohort - Animated Bar Chart</title>
      <link>/animation/2017-10-14-animated-bar-chart-percent-borrowers-by-cohort/</link>
      <pubDate>Sat, 14 Oct 2017 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2017-10-14-animated-bar-chart-percent-borrowers-by-cohort/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
NEW RELEASE: View the % of borrowers who took out fed &lt;a href=&#34;https://twitter.com/hashtag/studentloans?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#studentloans&lt;/a&gt; within 12 years of starting &lt;a href=&#34;https://twitter.com/hashtag/postsec?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#postsec&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/education?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#education&lt;/a&gt; &lt;a href=&#34;https://t.co/QRmwQMJGG0&#34;&gt;https://t.co/QRmwQMJGG0&lt;/a&gt; &lt;a href=&#34;https://t.co/ADugSRBrcB&#34;&gt;pic.twitter.com/ADugSRBrcB&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/916332882213457921?ref_src=twsrc%5Etfw&#34;&gt;October 6, 2017&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/barChart_Loans.gif&#34; alt=&#34;Percent of Borrowers by Cohort After 12 Years&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Percent of Borrowers by Cohort After 12 Years&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Median Debt By Educational Attainment - Animated Bar Chart</title>
      <link>/animation/2017-10-05-animated-bar-chart-twelve-year-debt/</link>
      <pubDate>Thu, 05 Oct 2017 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2017-10-05-animated-bar-chart-twelve-year-debt/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
What was the median amount owed by federal student loan borrowers 12 years after starting &lt;a href=&#34;https://twitter.com/hashtag/postsec?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#postsec&lt;/a&gt; ed? &lt;a href=&#34;https://t.co/QRmwQMJGG0&#34;&gt;https://t.co/QRmwQMJGG0&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/HigherEd?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#HigherEd&lt;/a&gt; &lt;a href=&#34;https://t.co/a6JmSm64Iw&#34;&gt;pic.twitter.com/a6JmSm64Iw&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/915993158546313217?ref_src=twsrc%5Etfw&#34;&gt;October 5, 2017&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/barChartLoans_Debt.gif&#34; alt=&#34;Twelve Year Median Debt Bar Chart&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Twelve Year Median Debt Bar Chart&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Charter School Enrollment, 2005 to 2015 - Animated State Grid Map</title>
      <link>/animation/2017-09-22-animated-charter-enrollment-state-grid-map/</link>
      <pubDate>Fri, 22 Sep 2017 00:00:00 +0000</pubDate>
      <author>mdlee12@gmail.com (Michael Lee)</author>
      <guid>/animation/2017-09-22-animated-charter-enrollment-state-grid-map/</guid>
      <description>&lt;div id=&#34;animation-seen-here&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Animation seen here:&lt;/h2&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
Learn about enrollment growth in &lt;a href=&#34;https://twitter.com/hashtag/CharterSchools?src=hash&#34;&gt;#CharterSchools&lt;/a&gt; by exploring our &lt;a href=&#34;https://twitter.com/hashtag/COE2017?src=hash&#34;&gt;#COE2017&lt;/a&gt; indicator: &lt;a href=&#34;https://t.co/5fYKCqMGH7&#34;&gt;https://t.co/5fYKCqMGH7&lt;/a&gt; &lt;a href=&#34;https://t.co/dBY4YdriCx&#34;&gt;pic.twitter.com/dBY4YdriCx&lt;/a&gt;
&lt;/p&gt;
— NCES (&lt;span class=&#34;citation&#34;&gt;@EdNCES&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/EdNCES/status/910615129343000576&#34;&gt;September 20, 2017&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;full-image&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Full image:&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/charter_State.gif&#34; alt=&#34;Charter School Enrollment State Grid Map&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Charter School Enrollment State Grid Map&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Interested in learning more? Hire me to consult on your next project, follow me on &lt;a href=&#34;https://twitter.com/mikeleeco&#34;&gt;twitter&lt;/a&gt;, leave a comment, or contact me via &lt;a href=&#34;mailto:mdlee12@gmail.com&#34;&gt;email&lt;/a&gt;. All inquiries welcome!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>